å¤ªå¥½äº†ğŸ‘ï¼Œä½ ç°åœ¨é—®çš„è¿™ä¸ªé—®é¢˜éå¸¸å…³é”® â€”â€”
**`std::bind` æ˜¯ C++11 å¼•å…¥çš„ä¸€ç§éå¸¸å¼ºå¤§çš„â€œå‡½æ•°é€‚é…å™¨(Function Adapter)â€**ã€‚
ç†è§£å®ƒï¼Œå°±èƒ½å½»åº•ææ‡‚ä¸ºä»€ä¹ˆå¾ˆå¤š ROS2ã€C++ å›è°ƒã€çº¿ç¨‹éƒ½è¿™ä¹ˆå†™ã€‚
æˆ‘ä»¬ä»æ˜“åˆ°éš¾è®²é€å®ƒğŸ‘‡

---

## ğŸš€ ä¸€ã€`std::bind` æ˜¯ä»€ä¹ˆï¼Ÿ

> ğŸ“˜ ç®€å•è¯´ï¼š
> `std::bind` å¯ä»¥â€œ**æå‰ç»‘å®š**â€ä¸€ä¸ªå‡½æ•°ï¼ˆåŒ…æ‹¬ç±»æˆå‘˜å‡½æ•°ï¼‰çš„ä¸€éƒ¨åˆ†å‚æ•°ï¼Œ
> ä»è€Œç”Ÿæˆä¸€ä¸ª**æ–°çš„å¯è°ƒç”¨å¯¹è±¡ï¼ˆcallable objectï¼‰**ã€‚

ä½ å¯ä»¥æŠŠå®ƒç†è§£ä¸ºï¼š

> â€œæˆ‘å…ˆé¢„è®¾å¥½å‡½æ•°çš„ä¸€äº›å‚æ•°ï¼Œç­‰ä»¥åå†å»æ‰§è¡Œã€‚â€

---

## ğŸ”¹åŸºæœ¬è¯­æ³•ï¼š

```cpp
auto callable = std::bind(å‡½æ•°å, å‚æ•°1, å‚æ•°2, ...);
```

è¿”å›å€¼ï¼šä¸€ä¸ª **å¯è°ƒç”¨å¯¹è±¡**ï¼ˆç±»ä¼¼å‡½æ•°ï¼‰
ä½ å¯ä»¥ä¹‹ååƒå‡½æ•°ä¸€æ ·è°ƒç”¨å®ƒï¼š

```cpp
callable();  // æ‰§è¡Œç»‘å®šå¥½çš„å‡½æ•°
```

---

## ğŸ§© äºŒã€åŸºç¡€ç¤ºä¾‹

### ğŸ§  ç¤ºä¾‹1ï¼šç»‘å®šæ™®é€šå‡½æ•°

```cpp
#include <iostream>
#include <functional>

void greet(const std::string &name) {
    std::cout << "Hello, " << name << std::endl;
}

int main() {
    auto say_hi = std::bind(greet, "Alice");
    say_hi(); // è¾“å‡ºï¼šHello, Alice
}
```

ğŸ” è§£é‡Šï¼š

* `std::bind(greet, "Alice")` è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°å¯¹è±¡
* è¿™ä¸ªå¯¹è±¡ç›¸å½“äºâ€œè°ƒç”¨ `greet("Alice")` çš„å¿«æ·æ–¹å¼â€

---

## ğŸ§  ç¤ºä¾‹2ï¼šç»‘å®šéƒ¨åˆ†å‚æ•°ï¼ˆå ä½ç¬¦ `_1`, `_2`ï¼‰

C++ æä¾›å ä½ç¬¦æ¥è¡¨ç¤º**â€œä»¥åå†ä¼ å…¥â€**çš„å‚æ•°ã€‚
è¿™äº›å ä½ç¬¦æ¥è‡ª `std::placeholders` å‘½åç©ºé—´ã€‚

```cpp
#include <iostream>
#include <functional>
using namespace std::placeholders;

void add(int a, int b) {
    std::cout << a + b << std::endl;
}

int main() {
    auto add_to_10 = std::bind(add, 10, _1);
    add_to_10(5);   // è¾“å‡º 15
}
```

ğŸ” è§£é‡Šï¼š

* `_1` è¡¨ç¤ºâ€œç¬¬ä¸€ä¸ªä»¥åä¼ å…¥çš„å‚æ•°â€
* `add_to_10(5)` â†’ ç­‰ä»·äº `add(10, 5)`

---

## ğŸ§  ç¤ºä¾‹3ï¼šç»‘å®šæˆå‘˜å‡½æ•°ï¼ˆé‡ç‚¹ï¼ï¼‰

```cpp
#include <iostream>
#include <functional>

class A {
public:
    void print_sum(int a, int b) {
        std::cout << "Sum: " << a + b << std::endl;
    }
};

int main() {
    A obj;
    auto bound_fn = std::bind(&A::print_sum, &obj, 10, _1);
    bound_fn(20);   // è¾“å‡º Sum: 30
}
```

ğŸ” è§£é‡Šï¼š

* `&A::print_sum` æ˜¯ **æˆå‘˜å‡½æ•°æŒ‡é’ˆ**
* `&obj` æ˜¯å¯¹è±¡å®ä¾‹æŒ‡é’ˆ
* `std::bind(&A::print_sum, &obj, 10, _1)` â†’ ç»‘å®šäº†å¯¹è±¡å’Œç¬¬ä¸€ä¸ªå‚æ•°

è¿™å°±æ˜¯ ROS2 å¸¸è§çš„å†™æ³•ï¼š

```cpp
std::bind(&ClassName::callback, this)
```

ğŸ‘‰ æ„æ€æ˜¯â€œç»‘å®šç±»é‡Œçš„æŸä¸ªæˆå‘˜å‡½æ•°åˆ°å½“å‰ this å¯¹è±¡ä¸Šâ€

---

## ğŸ§  ç¤ºä¾‹4ï¼šç»“åˆ `std::function`

å¾ˆå¤šåº“ï¼ˆåŒ…æ‹¬ ROS2ã€std::threadï¼‰éƒ½è¦æ±‚ä¼ å…¥ä¸€ä¸ª `std::function` å¯¹è±¡ã€‚
`std::bind` è¿”å›çš„å¯¹è±¡æ­£å¥½èƒ½è¢«éšå¼è½¬æ¢ä¸º `std::function`ã€‚

```cpp
#include <functional>
#include <iostream>
#include <thread>
using namespace std::placeholders;

class Worker {
public:
    void do_work(int id) {
        std::cout << "Working... " << id << std::endl;
    }
};

int main() {
    Worker w;
    std::function<void(int)> func = std::bind(&Worker::do_work, &w, _1);

    std::thread t(func, 42);
    t.join(); // è¾“å‡º Working... 42
}
```

---

## ğŸ§  ç¤ºä¾‹5ï¼šç»‘å®šä¸´æ—¶å¯¹è±¡ï¼ˆå±é™©ä½†å¸¸è§ï¼‰

```cpp
std::bind(&A::func, A(), _1);
```

âš ï¸ æ³¨æ„ï¼š`A()` æ˜¯ä¸ªä¸´æ—¶å¯¹è±¡ï¼Œ**æ‰§è¡Œå®Œè¿™è¡Œä»£ç åå°±é”€æ¯äº†ï¼**
è°ƒç”¨ç»‘å®šå‡½æ•°æ—¶ä¼šå´©æºƒã€‚
é™¤éä½¿ç”¨ `std::shared_ptr<A>`ï¼š

```cpp
auto a = std::make_shared<A>();
auto fn = std::bind(&A::func, a, _1);  // è‡ªåŠ¨å»¶é•¿ç”Ÿå‘½å‘¨æœŸ
```

è¿™ä¹Ÿæ˜¯ ROS2 ä¸­å¸¸ç”¨çš„åšæ³•ã€‚

---

## ğŸ§© ä¸‰ã€å ä½ç¬¦ `_1`, `_2`... è¯¦ç»†è§„åˆ™

* `_1` è¡¨ç¤ºç¬¬ä¸€ä¸ªå°†æ¥ä¼ å…¥çš„å‚æ•°
* `_2` è¡¨ç¤ºç¬¬äºŒä¸ªå°†æ¥ä¼ å…¥çš„å‚æ•°
* `_3` è¡¨ç¤ºç¬¬ä¸‰ä¸ªå°†æ¥ä¼ å…¥çš„å‚æ•°ï¼Œä»¥æ­¤ç±»æ¨

**ç¤ºä¾‹ï¼š**

```cpp
auto f = std::bind(func, _2, 100, _1);
f(10, 20); // ç›¸å½“äº func(20, 100, 10)
```

---

## ğŸ§  å››ã€ä¸ Lambda çš„å¯¹æ¯”

| ç‰¹æ€§        | `std::bind`     | Lambda        |
| --------- | --------------- | ------------- |
| å¯è¯»æ€§       | âŒ è¾ƒå·®            | âœ… æ›´ç›´è§‚         |
| æ€§èƒ½        | âœ… ä¸€èˆ¬ç•¥å¿«          | âœ… åŒæ ·é«˜æ•ˆ        |
| åŠŸèƒ½        | âœ… å¤æ‚ç»‘å®šï¼ˆå ä½ç¬¦ã€å¤šå‚æ•°ï¼‰ | âœ… æ›´çµæ´»ï¼ˆå¯ä»¥æ•è·å˜é‡ï¼‰ |
| ç°ä»£ C++ æ¨è | âŒ è¾ƒå°‘ä½¿ç”¨          | âœ… æ¨èä½¿ç”¨ Lambda |

ä¾‹å¦‚è¿™ä¸¤ç§å†™æ³•æ•ˆæœå®Œå…¨ä¸€æ ·ï¼š

```cpp
// ä½¿ç”¨ std::bind
timer_ = create_wall_timer(500ms, std::bind(&MinimalPublisher::timer_callback, this));

// ä½¿ç”¨ lambdaï¼ˆæ¨èï¼‰
timer_ = create_wall_timer(500ms, [this]() { timer_callback(); });
```

---

## âœ… äº”ã€æ€»ç»“è®°å¿†

| æ¦‚å¿µ          | å«ä¹‰                                  |
| ----------- | ----------------------------------- |
| `std::bind` | ç»‘å®šå‡½æ•°å’Œå‚æ•°ï¼Œç”Ÿæˆå¯è°ƒç”¨å¯¹è±¡                     |
| `_1`, `_2`  | å ä½ç¬¦ï¼Œè¡¨ç¤ºæœªæ¥è°ƒç”¨æ—¶å†ä¼ å…¥çš„å‚æ•°                   |
| æˆå‘˜å‡½æ•°ç»‘å®š      | `std::bind(&Class::func, this, _1)` |
| ä½œç”¨          | æå‰æŒ‡å®šå‡½æ•°éƒ¨åˆ†å‚æ•°ï¼Œæˆ–ç»‘å®šåˆ°å¯¹è±¡ä¸Š                  |
| æ›¿ä»£æ–¹æ¡ˆ        | Lambda è¡¨è¾¾å¼ï¼ˆC++11 ä¹‹åæ›´æ¨èï¼‰             |

---

å¦‚æœä½ æ„¿æ„ï¼Œæˆ‘å¯ä»¥å¸®ä½ ç”»ä¸€å¼ ã€Œ`std::bind` å†…éƒ¨å·¥ä½œæœºåˆ¶å›¾ã€ğŸ‘‡
å±•ç¤ºå®ƒå¦‚ä½•æŠŠâ€œå‡½æ•°æŒ‡é’ˆ + å‚æ•° + thisâ€ç»„åˆæˆä¸€ä¸ªå¯è°ƒç”¨å¯¹è±¡ã€‚
è¦æˆ‘ç”»ä¸€å¼ å—ï¼Ÿ
