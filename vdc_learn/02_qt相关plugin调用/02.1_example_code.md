```cpp
extern "C"
{
    AEBTRIGGERPLUGIN_EXPORT IPlugin *CreatePlugin()
    {
        return new AEBTriggerPlugin();
    }

---

    AvgFunction avg = (AvgFunction)library->resolve("CreatePlugin");
    if (!avg)
        return -2;
    IPlugin *plugin = avg();
    if (plugin == nullptr)
        return -2;
    plugin->init();
    {
        std::unique_lock<std::shared_mutex> lck(pluginMutex);
        registerCommand(plugin);
        m_plugins.insert(strName, plugin);
    }
    return 1;
}
```