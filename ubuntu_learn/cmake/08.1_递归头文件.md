你想用 **file(GLOB …)** 自动把一个文件夹下的**所有子目录**都加入到 include path？
可以做到，而且非常简洁。

---

# ✅ **方案 1：递归收集所有子目录并加入 include_directories**

```cmake
# 假设你的目录是 ${PROJECT_SOURCE_DIR}/src
file(GLOB_RECURSE ALL_DIRS LIST_DIRECTORIES true "${PROJECT_SOURCE_DIR}/src/*")

foreach(dir ${ALL_DIRS})
    if(IS_DIRECTORY ${dir})
        include_directories(${dir})
    endif()
endforeach()
```

### ✔ 会自动把 src 下所有子文件夹加入 include

### ✔ 自动递归

### ✔ 无需手动维护

---

# ⚠ 注意：file(GLOB) 默认不会收集目录

所以必须加：

```
LIST_DIRECTORIES true
```

否则不会匹配到目录，只会匹配文件。

---

# ✅ **方案 2：写成函数更优雅**

```cmake
function(add_include_recursive root)
    file(GLOB_RECURSE ALL_DIRS LIST_DIRECTORIES true "${root}/*")

    foreach(dir ${ALL_DIRS})
        if(IS_DIRECTORY ${dir})
            include_directories(${dir})
        endif()
    endforeach()
endfunction()

add_include_recursive(${PROJECT_SOURCE_DIR}/src)
```

---

# ✅ **方案 3：只包含第一层子目录（不递归）**

如果你只想第一层：

```cmake
file(GLOB ALL_DIRS LIST_DIRECTORIES true "${PROJECT_SOURCE_DIR}/src/*")

foreach(dir ${ALL_DIRS})
    if(IS_DIRECTORY ${dir})
        include_directories(${dir})
    endif()
endforeach()
```

---

# 🔥 最推荐（高级用法）：使用 target_include_directories

让 include 只作用于某个库/可执行程序，而不是全局：

```cmake
file(GLOB_RECURSE ALL_DIRS LIST_DIRECTORIES true "${CMAKE_CURRENT_SOURCE_DIR}/src/*")

set(INCLUDE_DIRS "")
foreach(dir ${ALL_DIRS})
    if(IS_DIRECTORY ${dir})
        list(APPEND INCLUDE_DIRS ${dir})
    endif()
endforeach()

target_include_directories(MyTarget PRIVATE ${INCLUDE_DIRS})
```

---

# 📌 你告诉我你的工程结构，我可以给你定制最简版本

比如：

```
project
 ├── include
 │    ├── a
 │    ├── b
 │    └── c
 └── src
```

我可以直接给你一行命令动态加入所有 include。
