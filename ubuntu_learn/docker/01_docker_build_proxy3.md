æ˜ç™½äº†ï¼Œä½ ç°åœ¨é‡åˆ°çš„é—®é¢˜ä¸æ˜¯ Docker æœ¬èº«ï¼Œè€Œæ˜¯ **ä»£ç†é…ç½®ä¸æ­£ç¡®**ã€‚ä»æ—¥å¿—æ¥çœ‹ï¼š

```
Could not connect to 127.0.0.1:7890 (127.0.0.1). - connect (111: Connection refused)
```

è¯´æ˜ Docker æ„å»ºè¿‡ç¨‹é‡Œè®¿é—®ç½‘ç»œæ—¶ï¼Œå°è¯•è¿æ¥ `127.0.0.1:7890`ï¼Œä½†æ˜¯ Docker å®¹å™¨é‡Œ `127.0.0.1` æŒ‡çš„æ˜¯å®¹å™¨è‡ªèº«ï¼Œè€Œä¸æ˜¯å®¿ä¸»æœºçš„ä»£ç†ï¼Œæ‰€ä»¥è¿æ¥å¤±è´¥ã€‚

---

### **è§£å†³æ–¹æ³•**

#### **æ–¹æ³• 1ï¼šç”¨å®¿ä¸»æœº IP æ›¿ä»£ 127.0.0.1**

Docker æ„å»ºé‡Œï¼Œä¸èƒ½ç”¨ `127.0.0.1` ä½œä¸ºä»£ç†åœ°å€ï¼Œéœ€è¦ç”¨å®¿ä¸»æœºåœ¨ Docker ç½‘ç»œä¸­çš„ IPã€‚ä¸€èˆ¬åœ¨ Linux ä¸Šå¯ä»¥ç”¨ `host.docker.internal`ï¼ˆæ–°ç‰ˆæœ¬ Docker æ”¯æŒï¼‰ï¼š

```bash
docker build \
  --build-arg http_proxy=http://host.docker.internal:7890 \
  --build-arg https_proxy=http://host.docker.internal:7890 \
  -t my_ros:cartographer_noetic ./
```

å¦‚æœä½ ç”¨çš„ Docker ç‰ˆæœ¬å¤ªæ—§ï¼Œä¸æ”¯æŒ `host.docker.internal`ï¼Œå¯ä»¥ç›´æ¥ç”¨å®¿ä¸»æœºçš„å±€åŸŸç½‘ IPï¼Œæ¯”å¦‚ `192.168.0.xxx:7890`ã€‚

---

#### **æ–¹æ³• 2ï¼šä½¿ç”¨ `--network=host`**

å¦‚æœä½ åªæ˜¯æƒ³è®© Docker æ„å»ºèƒ½èµ°å®¿ä¸»æœºç½‘ç»œï¼Œå¯ä»¥åŠ ä¸Šï¼š

```bash
docker build \
  --network=host \
  --build-arg http_proxy=http://127.0.0.1:7890 \
  --build-arg https_proxy=http://127.0.0.1:7890 \
  -t my_ros:cartographer_noetic ./
```

`--network=host` ä¼šè®©å®¹å™¨å…±äº«å®¿ä¸»æœºç½‘ç»œï¼Œæ­¤æ—¶ `127.0.0.1` å°±æ˜¯å®¿ä¸»æœºäº†ã€‚

âš ï¸ æ³¨æ„ï¼š`--network=host` åœ¨ macOS/Windows ä¸Šä¸å®Œå…¨ä¸€æ ·ï¼ŒLinux ä¸Šå¯ä»¥ç”¨ã€‚

---

#### **æ–¹æ³• 3ï¼šå¦‚æœä»£ç†æ˜¯ SOCKS5ï¼ˆå¸¸è§çš„ shadowsocks/v2rayï¼‰**

APT é»˜è®¤ä¸æ”¯æŒ SOCKS5ï¼Œéœ€è¦ç”¨ `tsocks` æˆ– `proxychains`ï¼Œæˆ–è€…ç”¨ HTTP ä»£ç†è½¬å‘ã€‚

ä¾‹å¦‚ç”¨ `redsocks` æˆ– `privoxy` è½¬ HTTPï¼Œå†è®¾ç½® `http_proxy=http://127.0.0.1:port`ã€‚

---

ğŸ’¡ **æ€»ç»“å»ºè®®ï¼š**

* Linux + HTTP ä»£ç† â†’ ç”¨æ–¹æ³• 1 æˆ– 2ã€‚
* SOCKS5 ä»£ç† â†’ å…ˆè½¬æˆ HTTP å†ç”¨æ–¹æ³• 1 æˆ– 2ã€‚
* ä¸ç”¨ä»£ç† â†’ ç›´æ¥ `docker build` å°±è¡Œã€‚

---

æˆ‘å¯ä»¥å¸®ä½ æ”¹æˆ**ç›´æ¥å¯ä»¥ç”¨ä»£ç†æˆåŠŸæ„å»º Cartographer ROS Dockerfile çš„å‘½ä»¤**ï¼Œä¿è¯ `apt-get update` ä¸æŠ¥é”™ã€‚ä½ å¸Œæœ›æˆ‘ç›´æ¥å†™å—ï¼Ÿ
