

# **è‡ªåŠ¨é©¾é©¶ç³»ç»Ÿå¼€å‘ç ”ç©¶æ‰‹å†Œï¼šä»ç¯å¢ƒæ­å»ºåˆ°ADASå®ç°çš„CARLAä¸ROSé›†æˆ**

---

## **ç¬¬ä¸€éƒ¨åˆ†ï¼šæ„å»ºä»¿çœŸç”Ÿæ€ç³»ç»Ÿ**

æœ¬éƒ¨åˆ†ä¸ºæ•´ä¸ªå¼€å‘æµç¨‹å¥ å®šå…³é”®åŸºç¡€ã€‚ä¸»è¦é‡ç‚¹æ˜¯ç†è§£å„ä¸ªç»„ä»¶ï¼Œå¹¶æˆåŠŸæ„å»ºä¸€ä¸ªç¨³å®šã€å…¼å®¹çš„è½¯ä»¶æ ˆï¼Œè¿™é€šå¸¸æ˜¯åˆå­¦è€…æœ€å®¹æ˜“å¤±è´¥çš„ç¯èŠ‚ã€‚

### **ç¬¬1èŠ‚ï¼šCARLA-ROSé›†æˆçš„æ¶æ„åŸºç¡€**

åœ¨æ·±å…¥ç ”ç©¶æŠ€æœ¯ç»†èŠ‚ä¹‹å‰ï¼Œå¿…é¡»é¦–å…ˆç†è§£æ„æˆè¯¥å¼ºå¤§ä»¿çœŸæ¡†æ¶çš„ä¸‰ä¸ªæ ¸å¿ƒç»„ä»¶ï¼šCARLAä»¿çœŸå™¨ã€æœºå™¨äººæ“ä½œç³»ç»Ÿï¼ˆROSï¼‰ä»¥åŠè¿æ¥ä¸¤è€…çš„æ¡¥æ¢ã€‚å®ƒä»¬å„è‡ªæ‰®æ¼”ç€ç‹¬ç‰¹çš„è§’è‰²ï¼Œå…±åŒæ„æˆäº†ä¸€ä¸ªç”¨äºå¼€å‘ã€æµ‹è¯•å’ŒéªŒè¯è‡ªåŠ¨é©¾é©¶ç®—æ³•çš„å®Œæ•´ç”Ÿæ€ç³»ç»Ÿã€‚

#### **1.1 CARLAï¼šé«˜ä¿çœŸæ•°å­—å­ªç”Ÿ**

CARLA (Car Learning to Act) è¿œä¸æ­¢ä¸€ä¸ªâ€œæ¸¸æˆå¼•æ“â€ï¼›å®ƒæ˜¯ä¸€ä¸ªä¸ºè‡ªåŠ¨é©¾é©¶ç ”ç©¶è€Œç”Ÿçš„å¼€æºç§‘å­¦å·¥å…· 1ã€‚CARLAçš„æ ¸å¿ƒä»·å€¼åœ¨äºå…¶èƒ½å¤Ÿç”Ÿæˆç‰©ç†ä¸Šå¯ä¿¡çš„ä¼ æ„Ÿå™¨æ•°æ®ï¼Œä¸ºè‡ªåŠ¨é©¾é©¶ç³»ç»Ÿçš„æ„ŸçŸ¥ç®—æ³•æä¾›æ¥è¿‘çœŸå®çš„è¾“å…¥ã€‚å®ƒæ”¯æŒçµæ´»çš„ä¼ æ„Ÿå™¨å¥—ä»¶é…ç½®ï¼ŒåŒ…æ‹¬æ¿€å…‰é›·è¾¾ï¼ˆLIDARï¼‰ã€é›·è¾¾ï¼ˆRadarï¼‰ã€å¤šç±»å‹æ‘„åƒå¤´ï¼ˆRGBã€æ·±åº¦ã€è¯­ä¹‰åˆ†å‰²ï¼‰ã€IMUå’ŒGNSSç­‰ 3ã€‚

CARLAé‡‡ç”¨å®¢æˆ·ç«¯-æœåŠ¡å™¨ï¼ˆClient-Serverï¼‰æ¶æ„ã€‚æœåŠ¡å™¨è´Ÿè´£è¿è¡Œä»¿çœŸä¸–ç•Œã€æ¸²æŸ“å›¾å½¢ã€è®¡ç®—ç‰©ç†åŠ¨æ€ä»¥åŠç®¡ç†æ‰€æœ‰é™æ€å’ŒåŠ¨æ€å‚ä¸è€…ï¼ˆå¦‚è½¦è¾†ã€è¡Œäººï¼‰ã€‚å®¢æˆ·ç«¯åˆ™é€šè¿‡å…¶å¼ºå¤§çš„Python APIä¸æœåŠ¡å™¨é€šä¿¡ï¼Œå…è®¸ç ”ç©¶äººå‘˜ä»¥ç¼–ç¨‹æ–¹å¼æ§åˆ¶ä»¿çœŸç¯å¢ƒçš„æ–¹æ–¹é¢é¢ï¼ŒåŒ…æ‹¬ç”Ÿæˆäº¤é€šæµã€æ”¹å˜å¤©æ°”æ¡ä»¶ã€ç”Ÿæˆå’Œé”€æ¯å‚ä¸è€…ï¼Œä»¥åŠä»ä¼ æ„Ÿå™¨ä¸­æ£€ç´¢æ•°æ® 5ã€‚è¿™ç§æ¶æ„å°†ç¹é‡çš„ä»¿çœŸè®¡ç®—ä¸ç”¨æˆ·çš„æ§åˆ¶é€»è¾‘åˆ†ç¦»å¼€æ¥ï¼Œæä¾›äº†æå¤§çš„çµæ´»æ€§å’Œå¯æ‰©å±•æ€§ã€‚

#### **1.2 ROSï¼šæœºå™¨äººé¢†åŸŸçš„æ ‡å‡†ä¸­é—´ä»¶**

æœºå™¨äººæ“ä½œç³»ç»Ÿï¼ˆROSï¼‰æ˜¯ä¸€ä¸ªä¸ºæœºå™¨äººè½¯ä»¶å¼€å‘æä¾›æœåŠ¡çš„æ¡†æ¶ï¼Œå®ƒå·²æˆä¸ºæœºå™¨äººå­¦å’Œè‡ªåŠ¨é©¾é©¶é¢†åŸŸçš„è¡Œä¸šæ ‡å‡†ã€‚ROSå¹¶éä¼ ç»Ÿæ„ä¹‰ä¸Šçš„æ“ä½œç³»ç»Ÿï¼Œè€Œæ˜¯ä¸€ä¸ªä¸­é—´ä»¶ï¼Œæä¾›äº†ä¸€ç³»åˆ—åº“å’Œå·¥å…·æ¥å¸®åŠ©è½¯ä»¶å¼€å‘è€…åˆ›å»ºæ¨¡å—åŒ–ã€å¯å¤ç”¨çš„æœºå™¨äººåº”ç”¨ç¨‹åº 7ã€‚

ROSçš„æ ¸å¿ƒæ¦‚å¿µåŒ…æ‹¬ï¼š

* **èŠ‚ç‚¹ (Nodes):** æ‰§è¡Œç‰¹å®šä»»åŠ¡çš„å¯æ‰§è¡Œç¨‹åºã€‚åœ¨è‡ªåŠ¨é©¾é©¶ä¸­ï¼Œä¸€ä¸ªèŠ‚ç‚¹å¯èƒ½è´Ÿè´£æ¿€å…‰é›·è¾¾æ•°æ®å¤„ç†ï¼Œå¦ä¸€ä¸ªè´Ÿè´£è·¯å¾„è§„åˆ’ï¼Œè¿˜æœ‰ä¸€ä¸ªè´Ÿè´£è½¦è¾†æ§åˆ¶ã€‚  
* **è¯é¢˜ (Topics):** èŠ‚ç‚¹ä¹‹é—´é€šè¿‡å‘å¸ƒï¼ˆpublishï¼‰å’Œè®¢é˜…ï¼ˆsubscribeï¼‰æ¶ˆæ¯è¿›è¡Œé€šä¿¡çš„å‘½åæ€»çº¿ã€‚ä¾‹å¦‚ï¼Œæ¿€å…‰é›·è¾¾èŠ‚ç‚¹ä¼šå‘/lidar\_pointsè¯é¢˜å‘å¸ƒç‚¹äº‘æ•°æ®ï¼Œè€Œæ„ŸçŸ¥èŠ‚ç‚¹åˆ™è®¢é˜…è¯¥è¯é¢˜ä»¥æ¥æ”¶æ•°æ®ã€‚  
* **æ¶ˆæ¯ (Messages):** åœ¨è¯é¢˜ä¸Šä¼ è¾“çš„æ•°æ®ç»“æ„ã€‚ROSä¸ºå¸¸ç”¨æ•°æ®ç±»å‹ï¼ˆå¦‚å›¾åƒã€ç‚¹äº‘ã€IMUæ•°æ®ï¼‰å®šä¹‰äº†æ ‡å‡†æ¶ˆæ¯æ ¼å¼ã€‚  
* **æœåŠ¡ (Services):** ä¸€ç§è¯·æ±‚/å“åº”å¼çš„é€šä¿¡æ¨¡å¼ï¼Œç”¨äºèŠ‚ç‚¹é—´çš„åŒæ­¥äº¤äº’ã€‚

ROSçš„æ¨¡å—åŒ–ç‰¹æ€§ä½¿å¾—æ„å»ºå¤æ‚çš„è‡ªåŠ¨é©¾é©¶è½¯ä»¶æ ˆå˜å¾—æ›´åŠ å®¹æ˜“ç®¡ç†ã€‚æ¯ä¸ªåŠŸèƒ½ï¼ˆæ„ŸçŸ¥ã€è§„åˆ’ã€æ§åˆ¶ï¼‰éƒ½å¯ä»¥å°è£…åœ¨ä¸€ä¸ªæˆ–å¤šä¸ªç‹¬ç«‹çš„èŠ‚ç‚¹ä¸­ï¼Œé€šè¿‡å®šä¹‰å¥½çš„è¯é¢˜æ¥å£è¿›è¡Œé€šä¿¡ï¼Œå®ç°äº†é«˜åº¦çš„è§£è€¦å’Œä»£ç å¤ç”¨ã€‚

#### **1.3 carla-ros-bridgeï¼šä¸­å¤®ç¥ç»ç³»ç»Ÿ**

carla-ros-bridgeæ˜¯è¿æ¥CARLAä»¿çœŸå™¨å’ŒROSç”Ÿæ€ç³»ç»Ÿçš„æ ¸å¿ƒç»„ä»¶ã€‚å®ƒæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªROSèŠ‚ç‚¹ï¼Œå…¶å†…éƒ¨è¿è¡Œä¸€ä¸ªCARLAå®¢æˆ·ç«¯ï¼Œä»è€Œåœ¨ä¸¤ä¸ªç‹¬ç«‹çš„ç³»ç»Ÿä¹‹é—´å»ºç«‹èµ·åŒå‘é€šä¿¡çš„æ¡¥æ¢ 3ã€‚

å…¶å·¥ä½œæœºåˆ¶å¯ä»¥æ¦‚æ‹¬ä¸ºï¼š

1. **ä»CARLAåˆ°ROSçš„ç¿»è¯‘ï¼š** æ¡¥æ¥å™¨è¿æ¥åˆ°æ­£åœ¨è¿è¡Œçš„CARLAæœåŠ¡å™¨ï¼Œå¹¶è®¢é˜…ä»¿çœŸä¸–ç•Œçš„çŠ¶æ€æ›´æ–°ã€‚å®ƒå°†CARLAä¸­çš„ä¿¡æ¯ï¼Œå¦‚ä¼ æ„Ÿå™¨æ•°æ®ï¼ˆæ‘„åƒå¤´å›¾åƒã€æ¿€å…‰é›·è¾¾ç‚¹äº‘ï¼‰ã€å‚ä¸è€…çŠ¶æ€ï¼ˆè½¦è¾†ä½ç½®ã€é€Ÿåº¦ï¼‰ã€äº¤é€šä¿¡å·ç¯çŠ¶æ€ç­‰ï¼Œè½¬æ¢æˆæ ‡å‡†çš„ROSæ¶ˆæ¯æ ¼å¼ï¼Œå¹¶å‘å¸ƒåˆ°ç›¸åº”çš„ROSè¯é¢˜ä¸Š 4ã€‚  
2. **ä»ROSåˆ°CARLAçš„ç¿»è¯‘ï¼š** åŒæ—¶ï¼Œæ¡¥æ¥å™¨è®¢é˜…ç‰¹å®šçš„ROSè¯é¢˜ï¼Œä»¥æ¥æ”¶æ¥è‡ªå…¶ä»–ROSèŠ‚ç‚¹çš„æŒ‡ä»¤ã€‚ä¾‹å¦‚ï¼Œå½“ä¸€ä¸ªæ§åˆ¶èŠ‚ç‚¹å‘/carla/ego\_vehicle/vehicle\_control\_cmdè¯é¢˜å‘å¸ƒè½¦è¾†æ§åˆ¶æ¶ˆæ¯ï¼ˆåŒ…å«æ²¹é—¨ã€åˆ¹è½¦ã€è½¬å‘å€¼ï¼‰æ—¶ï¼Œæ¡¥æ¥å™¨ä¼šæ¥æ”¶è¯¥æ¶ˆæ¯ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºCARLA Python APIå¯ä»¥ç†è§£çš„å‘½ä»¤ï¼Œå‘é€ç»™CARLAæœåŠ¡å™¨ä»¥æ§åˆ¶ä¸»è½¦ï¼ˆego vehicleï¼‰çš„è¿åŠ¨ 3ã€‚

é€šè¿‡è¿™ç§æ–¹å¼ï¼Œcarla-ros-bridgeæœ‰æ•ˆåœ°å°†CARLAä»¿çœŸå™¨â€œä¼ªè£…â€æˆä¸€ä¸ªçœŸå®çš„ã€å¸¦æœ‰ROSæ¥å£çš„æœºå™¨äººç¡¬ä»¶ã€‚è¿™ä½¿å¾—ä¸ºçœŸå®æœºå™¨äººå¼€å‘çš„ROSè½¯ä»¶æ ˆå¯ä»¥æ— ç¼åœ°åœ¨CARLAä¸­è¿›è¡Œæµ‹è¯•å’ŒéªŒè¯ï¼Œæå¤§åœ°åŠ é€Ÿäº†å¼€å‘å’Œè¿­ä»£è¿‡ç¨‹ã€‚

### **ç¬¬2èŠ‚ï¼šç¯å¢ƒå®‰è£…ä¸é…ç½®æƒå¨æŒ‡å—**

æˆåŠŸæ­å»ºä¸€ä¸ªç¨³å®šä¸”ç‰ˆæœ¬å…¼å®¹çš„å¼€å‘ç¯å¢ƒæ˜¯åˆ©ç”¨CARLA-ROSè¿›è¡Œç ”ç©¶çš„ç¬¬ä¸€æ­¥ï¼Œä¹Ÿæ˜¯æœ€å…³é”®çš„ä¸€æ­¥ã€‚ç”±äºè½¯ä»¶æ ˆæ¶‰åŠå¤šä¸ªå¿«é€Ÿè¿­ä»£çš„å¼€æºé¡¹ç›®ï¼Œç‰ˆæœ¬ä¸åŒ¹é…æ˜¯å¯¼è‡´å®‰è£…å¤±è´¥çš„æœ€å¸¸è§åŸå› ã€‚æœ¬èŠ‚å°†æä¾›ä¸€ä¸ªæ˜ç¡®ã€å¯å¤ç°çš„å·¥ä½œæµç¨‹ï¼Œå¸®åŠ©æ‚¨é¿å…å¸¸è§é™·é˜±ã€‚

#### **2.1 ç³»ç»Ÿå…ˆå†³æ¡ä»¶ä¸ç¡¬ä»¶å»ºè®®**

* **ç¡¬ä»¶è¦æ±‚ï¼š** è‡ªåŠ¨é©¾é©¶ä»¿çœŸæ˜¯è®¡ç®—å¯†é›†å‹ä»»åŠ¡ï¼Œå°¤å…¶æ˜¯åœ¨å›¾å½¢æ¸²æŸ“æ–¹é¢ã€‚å¼ºçƒˆå»ºè®®ä½¿ç”¨é…å¤‡å¼ºå¤§NVIDIA GPUï¼ˆä¾‹å¦‚ï¼ŒRTXç³»åˆ—ï¼Œæ˜¾å­˜ä¸ä½äº6 GBï¼‰çš„è®¡ç®—æœºï¼Œä»¥ç¡®ä¿ä»¿çœŸæµç•…è¿è¡Œ 1ã€‚  
* **è½¯ä»¶è¦æ±‚ï¼š** æœ¬æŒ‡å—å°†ä»¥**Ubuntu 22.04 LTS**ä½œä¸ºæ ‡å‡†æ“ä½œç³»ç»Ÿã€‚æ­¤å¤–ï¼Œè¿˜éœ€è¦ç‰¹å®šç‰ˆæœ¬çš„Pythonï¼ˆé€šå¸¸æ˜¯3.8æˆ–3.10ï¼Œå–å†³äºCARLAå’ŒROSçš„ç‰ˆæœ¬ï¼‰ã€gitç‰ˆæœ¬æ§åˆ¶å·¥å…·ä»¥åŠç›¸å…³çš„ç¼–è¯‘å·¥å…·é“¾ 12ã€‚

#### **2.2 æ ¸å¿ƒç»„ä»¶åˆ†æ­¥å®‰è£…**

**1\. å®‰è£…ROS 2 Humble Hawksbill (é€‚ç”¨äºUbuntu 22.04)**

ROS 2 Humbleæ˜¯ä¸Ubuntu 22.04 LTSåŒ¹é…çš„é•¿æœŸæ”¯æŒç‰ˆæœ¬ã€‚è¯·ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œ 12ï¼š

Bash

\# 1\. è®¾ç½®åŒºåŸŸè®¾ç½®ï¼Œç¡®ä¿æ”¯æŒUTF-8  
sudo apt update && sudo apt install locales  
sudo locale-gen en\_US en\_US.UTF-8  
sudo update-locale LC\_ALL=en\_US.UTF-8 LANG=en\_US.UTF-8  
export LANG=en\_US.UTF-8

\# 2\. æ·»åŠ ROS 2çš„APTä»“åº“  
sudo apt install software-properties-common  
sudo add-apt-repository universe  
sudo apt update && sudo apt install curl \-y  
sudo curl \-sSL https://raw.githubusercontent.com/ros/rosdistro/master/ros.key \-o /usr/share/keyrings/ros-archive-keyring.gpg  
echo "deb \[arch=$(dpkg \--print-architecture) signed-by=/usr/share/keyrings/ros-archive-keyring.gpg\] http://packages.ros.org/ros2/ubuntu $(. /etc/os-release && echo $UBUNTU\_CODENAME) main" | sudo tee /etc/apt/sources.list.d/ros2.list \> /dev/null

\# 3\. å®‰è£…ROS 2æ¡Œé¢å®Œæ•´ç‰ˆ  
sudo apt update  
sudo apt install ros-humble-desktop-full

\# 4\. é…ç½®ç¯å¢ƒ  
echo "source /opt/ros/humble/setup.bash" \>\> \~/.bashrc  
source \~/.bashrc

**2\. å®‰è£…CARLAä»¿çœŸå™¨**

å»ºè®®ä½¿ç”¨CARLAçš„é¢„ç¼–è¯‘ç‰ˆæœ¬ï¼Œä»¥é¿å…ä»æºç ç¼–è¯‘çš„å¤æ‚è¿‡ç¨‹ã€‚

Bash

\# 1\. ä»CARLAçš„GitHubå‘å¸ƒé¡µé¢ä¸‹è½½ä¸æ‚¨çš„ç³»ç»ŸåŒ¹é…çš„ç‰ˆæœ¬ï¼ˆä¾‹å¦‚ï¼Œ0.9.14æˆ–0.9.15ï¼‰  
\# å‡è®¾ä¸‹è½½äº† CARLA\_0.9.14.tar.gz  
mkdir \~/carla\_simulator  
tar \-xvzf CARLA\_0.9.14.tar.gz \-C \~/carla\_simulator

\# 2\. å®‰è£…CARLA Python API  
\# CARLAçš„Python APIä»¥.eggæˆ–.whlæ–‡ä»¶çš„å½¢å¼æä¾›ï¼Œå¿…é¡»ä¸æ‚¨çš„Pythonç‰ˆæœ¬åŒ¹é…ã€‚  
\# å¯¹äºUbuntu 22.04 (Python 3.10)ï¼Œæ‚¨å¯èƒ½éœ€è¦ä»ç¤¾åŒºä»“åº“ä¸‹è½½é€‚é…çš„æ–‡ä»¶ã€‚  
\# ä¾‹å¦‚ï¼Œä» gezp/carla\_ros çš„å‘å¸ƒé¡µé¢ä¸‹è½½ carla-0.9.14-py3.10-linux-x86\_64.egg  
\# å°†ä¸‹è½½çš„æ–‡ä»¶æ”¾å…¥ \~/carla\_simulator/PythonAPI/carla/dist/ ç›®å½•  
pip3 install \--user \~/carla\_simulator/PythonAPI/carla/dist/carla-0.9.14-cp310-cp310-linux\_x86\_64.whl \# å¦‚æœæ˜¯.whlæ–‡ä»¶  
\# æˆ–è€…é…ç½®PYTHONPATH  
echo "export CARLA\_ROOT=\~/carla\_simulator" \>\> \~/.bashrc  
echo "export PYTHONPATH=$PYTHONPATH:$CARLA\_ROOT/PythonAPI/carla/dist/carla-0.9.14-py3.10-linux-x86\_64.egg" \>\> \~/.bashrc  
source \~/.bashrc

#### **2.3 æ„å»ºcarla-ros-bridgeï¼šé©¾é©­Forkç”Ÿæ€ç³»ç»Ÿ**

è¿™æ˜¯æ•´ä¸ªå®‰è£…è¿‡ç¨‹ä¸­æœ€éœ€è¦æ³¨æ„çš„ç¯èŠ‚ã€‚å®˜æ–¹çš„carla-simulator/ros-bridgeä»“åº“ï¼ˆ11ï¼‰æ›´æ–°é€šå¸¸æ»åäºæœ€æ–°çš„ROSå‘è¡Œç‰ˆã€‚ç›´æ¥ä½¿ç”¨å®˜æ–¹ä¸»åˆ†æ”¯åœ¨ROS 2 Humbleä¸Šç¼–è¯‘å‡ ä¹ä¸€å®šä¼šå¤±è´¥ã€‚æˆåŠŸçš„å…³é”®åœ¨äºé€‰æ‹©ä¸€ä¸ªç”±ç¤¾åŒºç»´æŠ¤ã€æ˜ç¡®æ”¯æŒæ‚¨æ‰€ç”¨CARLAå’ŒROSç‰ˆæœ¬çš„Forkä»“åº“ã€‚

è¿™ä¸ªé—®é¢˜çš„æ ¹æºåœ¨äºè½¯ä»¶æ ˆçš„å¿«é€Ÿæ¼”è¿›ã€‚å½“ä¸€ä¸ªæ–°çš„Ubuntu LTSç‰ˆæœ¬å‘å¸ƒæ—¶ï¼ˆå¦‚22.04ï¼‰ï¼ŒROSç¤¾åŒºä¼šæ¨å‡ºæ–°çš„LTSç‰ˆæœ¬ï¼ˆå¦‚Humbleï¼‰ã€‚ç„¶è€Œï¼ŒCARLAå’Œros-bridgeçš„å®˜æ–¹ç»´æŠ¤è€…å¯èƒ½éœ€è¦æ—¶é—´æ¥è·Ÿè¿›è¿™äº›æ›´æ–°ï¼Œå¯¼è‡´åœ¨å®˜æ–¹æ”¯æŒå‘å¸ƒä¹‹å‰å­˜åœ¨ä¸€ä¸ªâ€œå…¼å®¹æ€§çœŸç©ºæœŸâ€ã€‚åœ¨æ­¤æœŸé—´ï¼Œç¤¾åŒºå¼€å‘è€…ä¼šåˆ›å»ºåˆ†æ”¯æˆ–Forkï¼Œè‡ªè¡Œä¿®å¤å…¼å®¹æ€§é—®é¢˜ï¼Œä»¥æ»¡è¶³å‰æ²¿ç ”ç©¶çš„éœ€æ±‚ã€‚å› æ­¤ï¼Œé€‰æ‹©æ­£ç¡®çš„Forkä¸æ˜¯ä¸€ä¸ªâ€œæ·å¾„â€ï¼Œè€Œæ˜¯å½“å‰åœ¨ç°ä»£ç³»ç»Ÿä¸Šè¿›è¡Œå¼€å‘çš„å¿…è¦æ­¥éª¤ã€‚

**æ„å»ºæ­¥éª¤ï¼š**

Bash

\# 1\. åˆ›å»ºä¸€ä¸ªcolconå·¥ä½œç©ºé—´  
mkdir \-p \~/carla\_ws/src  
cd \~/carla\_ws

\# 2\. æ ¹æ®æ‚¨çš„CARLAç‰ˆæœ¬ï¼Œå…‹éš†æ­£ç¡®çš„ros-bridge Fork  
\# ç¤ºä¾‹ï¼šå¯¹äºCARLA 0.9.15 å’Œ ROS 2 Humbleï¼Œä½¿ç”¨ttgamageçš„Fork   
git clone \--recurse-submodules https://github.com/ttgamage/carla-ros-bridge.git src/ros-bridge  
\# ç¤ºä¾‹ï¼šå¯¹äºCARLA 0.9.14 å’Œ ROS 2 Humbleï¼Œä½¿ç”¨gezpçš„Fork   
\# git clone \--recurse-submodules https://github.com/gezp/carla\_ros.git \-b humble-carla-0.9.14 src/ros-bridge

\# 3\. å®‰è£…ä¾èµ–é¡¹  
source /opt/ros/humble/setup.bash  
sudo apt-get update  
rosdep update  
rosdep install \--from-paths src \--ignore-src \-r \-y

\# 4\. ç¼–è¯‘å·¥ä½œç©ºé—´  
colcon build \--symlink-install

#### **è¡¨ 2.1: ç‰ˆæœ¬å…¼å®¹æ€§çŸ©é˜µ**

ä¸ºäº†ä»æ ¹æœ¬ä¸Šè§£å†³ç‰ˆæœ¬åŒ¹é…é—®é¢˜ï¼Œä¸‹è¡¨æ•´åˆäº†æ¥è‡ªä¸åŒæ¥æºçš„ä¿¡æ¯ï¼Œä¸ºå¸¸è§çš„ç³»ç»Ÿé…ç½®æä¾›äº†æ˜ç¡®çš„æŒ‡å¯¼è·¯å¾„ã€‚è¿™å¼ è¡¨æ ¼æ˜¯ç¡®ä¿å®‰è£…æˆåŠŸçš„å…³é”®å‚è€ƒã€‚

| Ubuntu ç‰ˆæœ¬ | ROS å‘è¡Œç‰ˆ | CARLA ç‰ˆæœ¬ | æ¨èçš„ ros-bridge Fork | å…³é”®è¯´æ˜ |
| :---- | :---- | :---- | :---- | :---- |
| 22.04 LTS | ROS 2 Humble | 0.9.15 | https://github.com/ttgamage/carla-ros-bridge 13 | éœ€è¦Python 3.10çš„å®¢æˆ·ç«¯åº“ã€‚ |
| 22.04 LTS | ROS 2 Humble | 0.9.14 | https://github.com/gezp/carla\_ros 14 | Forkçš„å‘å¸ƒé¡µé¢æä¾›äº†é¢„ç¼–è¯‘çš„Python 3.10 .whl æ–‡ä»¶ã€‚ |
| 20.04 LTS | ROS 2 Foxy | 0.9.13 | https://github.com/carla-simulator/ros-bridge (å®˜æ–¹) 11 | å®˜æ–¹æ”¯æŒçš„ç»„åˆï¼Œç›¸å¯¹ç¨³å®šã€‚ |
| 18.04 LTS | ROS Melodic | 0.9.9 | https://github.com/carla-simulator/ros-bridge (å®˜æ–¹, æ£€å‡º 0.9.8 æ ‡ç­¾) 15 | åŸºäºROS 1çš„ç»å…¸é…ç½®ã€‚ |

---

## **ç¬¬äºŒéƒ¨åˆ†ï¼šæŒæ¡CARLA-ROSæ¥å£**

æˆåŠŸæ­å»ºç¯å¢ƒåï¼Œä¸‹ä¸€æ­¥æ˜¯æ·±å…¥ç†è§£å¹¶ç†Ÿç»ƒä½¿ç”¨carla-ros-bridgeã€‚æœ¬éƒ¨åˆ†å°†è§£æ„æ¡¥æ¥å™¨çš„åŠŸèƒ½ï¼Œå¹¶é€šè¿‡ä¸€ä¸ªåŠ¨æ‰‹å®è·µçš„æ•™ç¨‹ï¼Œå¸®åŠ©æ‚¨å»ºç«‹å¯¹ä»¿çœŸç¯å¢ƒçš„ç›´è§‚è®¤è¯†å’Œæ“æ§ä¿¡å¿ƒã€‚

### **ç¬¬3èŠ‚ï¼šcarla-ros-bridgeæ·±åº¦è§£æ**

carla-ros-bridgeä¸ä»…ä»…æ˜¯ä¸€ä¸ªå•ä¸€çš„ç¨‹åºï¼Œå®ƒæ˜¯ä¸€ä¸ªåŒ…å«å¤šä¸ªROSåŒ…çš„é›†åˆï¼Œæ¯ä¸ªåŒ…éƒ½æä¾›äº†ç‰¹å®šçš„åŠŸèƒ½ï¼Œå…±åŒæ„æˆäº†CARLAä¸ROSä¹‹é—´çš„å®Œæ•´æ¥å£ã€‚

#### **3.1 æ ¸å¿ƒåŒ…ä¸èŠ‚ç‚¹åˆ†æ**

ros-bridgeå·¥ä½œç©ºé—´å†…é€šå¸¸åŒ…å«ä»¥ä¸‹å‡ ä¸ªå…³é”®çš„ROSåŒ… 9ï¼š

* carla\_ros\_bridge: è¿™æ˜¯æœ€æ ¸å¿ƒçš„åŒ…ï¼ŒåŒ…å«äº†å¯åŠ¨æ¡¥æ¥å™¨æœ¬èº«çš„ä¸»èŠ‚ç‚¹ã€‚å®ƒè´Ÿè´£å¤„ç†CARLAä¸ROSä¹‹é—´çš„æ‰€æœ‰åŸºæœ¬æ•°æ®è½¬æ¢å’Œé€šä¿¡ã€‚  
* carla\_spawn\_objects: æä¾›äº†ä¸€ä¸ªé€šç”¨çš„æ¥å£ï¼Œå…è®¸ç”¨æˆ·é€šè¿‡ROSæœåŠ¡ï¼ˆserviceï¼‰æˆ–å¯åŠ¨æ–‡ä»¶ï¼ˆlaunch fileï¼‰åœ¨CARLAä¸–ç•Œä¸­ç”Ÿæˆè½¦è¾†ã€è¡Œäººã€ä¼ æ„Ÿå™¨ç­‰å‚ä¸è€…ï¼ˆactorsï¼‰ã€‚  
* carla\_manual\_control: æä¾›äº†ä¸€ä¸ªåŸºäºROSçš„å¯è§†åŒ–æ‰‹åŠ¨æ§åˆ¶å·¥å…·ï¼Œç±»ä¼¼äºCARLAè‡ªå¸¦çš„manual\_control.pyè„šæœ¬ã€‚å®ƒä¼šè®¢é˜…ä¼ æ„Ÿå™¨æ•°æ®ï¼ˆå¦‚æ‘„åƒå¤´å›¾åƒï¼‰å¹¶æ˜¾ç¤ºåœ¨ä¸€ä¸ªPyGameçª—å£ä¸­ï¼ŒåŒæ—¶å°†ç”¨æˆ·çš„é”®ç›˜è¾“å…¥è½¬æ¢ä¸ºè½¦è¾†æ§åˆ¶æŒ‡ä»¤å‘å¸ƒå‡ºå»ã€‚  
* carla\_ackermann\_control: ä¸€ä¸ªæ§åˆ¶å™¨èŠ‚ç‚¹ï¼Œç”¨äºå°†æ ‡å‡†çš„AckermannDriveæ¶ˆæ¯ï¼ˆåŒ…å«é€Ÿåº¦å’Œè½¬å‘è§’ï¼‰è½¬æ¢ä¸ºCARLAåŸç”Ÿçš„CarlaEgoVehicleControlæ¶ˆæ¯ï¼ˆåŒ…å«æ²¹é—¨ã€åˆ¹è½¦ã€è½¬å‘å€¼ï¼‰ã€‚è¿™å¯¹äºé›†æˆè®¸å¤šç°æœ‰çš„è‡ªåŠ¨é©¾é©¶è½¯ä»¶æ ˆéå¸¸æœ‰ç”¨ã€‚  
* carla\_ad\_demo: ä¸€ä¸ªå®Œæ•´çš„æ¼”ç¤ºåŒ…ï¼Œå®ƒæä¾›äº†ä¸€é”®å¯åŠ¨æ•´ä¸ªCARLA-ROSç¯å¢ƒæ‰€éœ€çš„æ‰€æœ‰é…ç½®æ–‡ä»¶å’Œå¯åŠ¨æ–‡ä»¶ï¼ŒåŒ…æ‹¬ç”Ÿæˆä¸€è¾†é…å¤‡å®Œæ•´ä¼ æ„Ÿå™¨çš„è‡ªåŠ¨é©¾é©¶ä¸»è½¦ã€‚è¿™æ˜¯å­¦ä¹ å’Œç†è§£å¦‚ä½•ç»„ç»‡ä¸€ä¸ªå®Œæ•´é¡¹ç›®çš„ç»ä½³èµ·ç‚¹ã€‚

#### **3.2 ä»¿çœŸæ§åˆ¶ï¼šåŒæ­¥æ¨¡å¼çš„å…³é”®æ€§**

åœ¨CARLA-ROSä»¿çœŸä¸­ï¼Œå­˜åœ¨ä¸¤ç§è¿è¡Œæ¨¡å¼ï¼šå¼‚æ­¥æ¨¡å¼å’ŒåŒæ­¥æ¨¡å¼ã€‚è™½ç„¶å¼‚æ­¥æ¨¡å¼è®¾ç½®ç®€å•ï¼Œä½†å¯¹äºä»»ä½•ä¸¥è‚ƒçš„ç§‘å­¦ç ”ç©¶æˆ–ç®—æ³•éªŒè¯ï¼Œ**åŒæ­¥æ¨¡å¼éƒ½æ˜¯å¿…ä¸å¯å°‘çš„**ã€‚

å…¶èƒŒåçš„å› æœå…³ç³»å¦‚ä¸‹ï¼šç§‘å­¦å®éªŒè¦æ±‚ç»“æœæ˜¯å¯å¤ç°çš„ã€‚åœ¨ä¸€ä¸ªç”±CARLAæœåŠ¡å™¨å’Œå¤šä¸ªROSèŠ‚ç‚¹ç»„æˆçš„å¤æ‚åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œç½‘ç»œå»¶è¿Ÿå’Œè®¡ç®—æ—¶é—´çš„æ³¢åŠ¨æ˜¯ä¸å¯é¿å…çš„ã€‚åœ¨å¼‚æ­¥æ¨¡å¼ä¸‹ï¼ŒCARLAæœåŠ¡å™¨ä»¥å…¶å›ºå®šçš„æ—¶é—´æ­¥é•¿ï¼ˆtickï¼‰ç‹¬ç«‹è¿è¡Œï¼Œè€ŒROSæ¡¥æ¥å™¨åˆ™å°½å…¶æ‰€èƒ½åœ°æ¥æ”¶å’Œå‘å¸ƒæ•°æ®ã€‚è¿™ä¼šå¯¼è‡´ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ï¼šæ•°æ®ä¸åŒæ­¥ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªç®—æ³•èŠ‚ç‚¹å¯èƒ½åœ¨åŒä¸€æ—¶åˆ»æ”¶åˆ°äº†æ¥è‡ªç¬¬Nä¸ªä»¿çœŸæ—¶åˆ»çš„æ‘„åƒå¤´å›¾åƒï¼Œä½†å´æ”¶åˆ°äº†æ¥è‡ªç¬¬N+1ä¸ªæ—¶åˆ»çš„æ¿€å…‰é›·è¾¾ç‚¹äº‘ã€‚åŸºäºè¿™ç§æ—¶é—´ä¸Šé”™ä½çš„æ•°æ®è¿›è¡Œèåˆå’Œå†³ç­–ï¼Œå°†å¯¼è‡´å¯¹ä¸–ç•ŒçŠ¶æ€çš„é”™è¯¯æ„ŸçŸ¥ï¼Œå…¶ç»“æœæ˜¯éšæœºä¸”ä¸å¯å¤ç°çš„ã€‚

åŒæ­¥æ¨¡å¼ï¼ˆé€šè¿‡åœ¨å¯åŠ¨æ¡¥æ¥å™¨æ—¶è®¾ç½®synchronous\_mode:=Trueï¼‰è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚åœ¨è¯¥æ¨¡å¼ä¸‹ï¼ŒCARLAæœåŠ¡å™¨çš„â€œæ—¶é’Ÿâ€è¢«æš‚åœï¼Œå®ƒä¸ä¼šè‡ªåŠ¨å‰è¿›ã€‚ç›¸åï¼Œå®ƒä¼šç­‰å¾…å®¢æˆ·ç«¯ï¼ˆå³carla-ros-bridgeï¼‰å‘é€ä¸€ä¸ªâ€œtickâ€æŒ‡ä»¤åï¼Œæ‰å°†ä»¿çœŸæ¨è¿›ä¸€ä¸ªæ—¶é—´æ­¥ã€‚æ¡¥æ¥å™¨èŠ‚ç‚¹åˆ™éµå¾ªä¸€ä¸ªä¸¥æ ¼çš„é€»è¾‘ï¼šåªæœ‰åœ¨å½“å‰ä»¿çœŸæ—¶åˆ»çš„æ‰€æœ‰ä¼ æ„Ÿå™¨æ•°æ®éƒ½å·²æˆåŠŸæ¥æ”¶å¹¶å‘å¸ƒåˆ°ROSè¯é¢˜ä¹‹åï¼Œå®ƒæ‰ä¼šå‘æœåŠ¡å™¨å‘é€ä¸‹ä¸€ä¸ªâ€œtickâ€æŒ‡ä»¤ 17ã€‚

è¿™ç§æœºåˆ¶è™½ç„¶å¯èƒ½ä¼šé™ä½ä»¿çœŸçš„å®æ—¶è¿è¡Œé€Ÿåº¦ï¼Œä½†å®ƒç¡®ä¿äº†åœ¨ä»»ä½•ä¸€ä¸ªROSæ—¶é—´æˆ³ä¸‹ï¼Œæ‰€æœ‰ä¼ æ„Ÿå™¨æ•°æ®éƒ½ä¸¥æ ¼å¯¹åº”äºåŒä¸€ä¸ªCARLAä»¿çœŸæ—¶åˆ»ï¼Œä»è€Œä¿è¯äº†æ•°æ®çš„ä¸€è‡´æ€§å’Œå®éªŒçš„å¯å¤ç°æ€§ã€‚

**å…³é”®å¯åŠ¨å‚æ•°** 18ï¼š

* host å’Œ port: è¿æ¥CARLAæœåŠ¡å™¨çš„ç½‘ç»œåœ°å€å’Œç«¯å£ã€‚  
* timeout: è¿æ¥æœåŠ¡å™¨çš„è¶…æ—¶æ—¶é—´ã€‚  
* fixed\_delta\_seconds: ä»¿çœŸæ—¶é—´æ­¥é•¿ï¼ˆç§’ï¼‰ã€‚ä¸ºäº†ä¿è¯ç‰©ç†ä»¿çœŸçš„ç¨³å®šæ€§ï¼Œè¯¥å€¼å¿…é¡»å°äº0.1ã€‚  
* passive: åœ¨å¤šå®¢æˆ·ç«¯åŒæ­¥æ¨¡å¼ä¸‹ä½¿ç”¨ã€‚å½“è®¾ç½®ä¸ºTrueæ—¶ï¼Œæ¡¥æ¥å™¨ä¸ä¼šä¸»åŠ¨â€œtickâ€ä¸–ç•Œï¼Œè€Œæ˜¯è¢«åŠ¨åœ°ç­‰å¾…å…¶ä»–å®¢æˆ·ç«¯æ¥æ¨è¿›ä»¿çœŸã€‚

#### **è¡¨ 3.1: å…³é”®ROSè¯é¢˜ä¸æ¶ˆæ¯**

ä¸‹è¡¨æ±‡æ€»äº†ä¸ä»¿çœŸè½¦è¾†å’Œä¸–ç•Œäº¤äº’æ‰€éœ€çš„æœ€å¸¸ç”¨ROSè¯é¢˜ï¼Œä¸ºå¼€å‘è€…æä¾›äº†ä¸€ä»½å¿«é€Ÿå‚è€ƒçš„â€œAPIæ–‡æ¡£â€ã€‚è¿™å¡«è¡¥äº†å®˜æ–¹æ–‡æ¡£ä¸­çš„ä¸€ä¸ªç©ºç™½ï¼Œæ•´åˆäº†ä»å„ä¸ªä»£ç åº“å’Œç¤ºä¾‹ä¸­æ”¶é›†çš„å®ç”¨ä¿¡æ¯ã€‚

| åŠŸèƒ½ | ROS è¯é¢˜æ¨¡å¼ | æ¶ˆæ¯ç±»å‹ | æè¿° |
| :---- | :---- | :---- | :---- |
| RGBæ‘„åƒå¤´ | /carla/\<role\_name\>/camera/rgb/\<sensor\_name\>/image\_color | sensor\_msgs/Image | æ¥è‡ªRGBæ‘„åƒå¤´çš„åŸå§‹å›¾åƒæ•°æ®ã€‚ 19 |
| æ¿€å…‰é›·è¾¾ (LiDAR) | /carla/\<role\_name\>/lidar/\<sensor\_name\>/point\_cloud | sensor\_msgs/PointCloud2 | æ¥è‡ªæ¿€å…‰é›·è¾¾ä¼ æ„Ÿå™¨çš„3Dç‚¹äº‘æ•°æ®ã€‚ 20 |
| æƒ¯æ€§æµ‹é‡å•å…ƒ (IMU) | /carla/\<role\_name\>/imu/\<sensor\_name\>/imu | sensor\_msgs/Imu | æƒ¯æ€§æµ‹é‡æ•°æ®ï¼ŒåŒ…æ‹¬è§’é€Ÿåº¦å’Œçº¿æ€§åŠ é€Ÿåº¦ã€‚ 20 |
| å…¨çƒå¯¼èˆªå«æ˜Ÿç³»ç»Ÿ (GNSS) | /carla/\<role\_name\>/gnss/\<sensor\_name\>/fix | sensor\_msgs/NavSatFix | æä¾›ç»åº¦ã€çº¬åº¦å’Œæµ·æ‹”ä¿¡æ¯ã€‚ 19 |
| è½¦è¾†çŠ¶æ€ (é‡Œç¨‹è®¡) | /carla/\<role\_name\>/odometry | nav\_msgs/Odometry | è½¦è¾†çš„ä½å§¿ï¼ˆä½ç½®å’Œå§¿æ€ï¼‰å’Œé€Ÿåº¦ä¿¡æ¯ã€‚ 20 |
| è½¦è¾†åŸç”Ÿæ§åˆ¶ | /carla/\<role\_name\>/vehicle\_control\_cmd | carla\_msgs/CarlaEgoVehicleControl | ç›´æ¥çš„æ²¹é—¨(0-1)ã€è½¬å‘(-1-1)ã€åˆ¹è½¦(0-1)æŒ‡ä»¤ã€‚ 17 |
| é˜¿å…‹æ›¼æ§åˆ¶ | /carla/\<role\_name\>/ackermann\_cmd | ackermann\_msgs/AckermannDrive | é˜¿å…‹æ›¼å¼æ§åˆ¶æŒ‡ä»¤ï¼ˆé€Ÿåº¦å’Œè½¬å‘è§’ï¼‰ã€‚ 17 |
| ç›®æ ‡æ£€æµ‹ (çœŸå€¼) | /carla/objects | derived\_object\_msgs/ObjectArray | ä¸–ç•Œä¸­å…¶ä»–å‚ä¸è€…ï¼ˆè½¦è¾†ã€è¡Œäººï¼‰çš„çœŸå€¼è¾¹ç•Œæ¡†å’Œä¿¡æ¯ã€‚ 19 |
| ç¢°æ’æ£€æµ‹ | /carla/\<role\_name\>/collision | carla\_msgs/CarlaCollisionEvent | å½“ä¸»è½¦å‘ç”Ÿç¢°æ’æ—¶å‘å¸ƒäº‹ä»¶æ¶ˆæ¯ã€‚ 19 |
| è½¦é“ä¾µå…¥æ£€æµ‹ | /carla/\<role\_name\>/lane\_invasion | carla\_msgs/CarlaLaneInvasionEvent | å½“ä¸»è½¦å‹åˆ°è½¦é“çº¿æ—¶å‘å¸ƒäº‹ä»¶æ¶ˆæ¯ã€‚ 19 |

*æ³¨ï¼š\<role\_name\>é€šå¸¸æ˜¯ego\_vehicleï¼Œ\<sensor\_name\>æ˜¯åœ¨ç”Ÿæˆä¼ æ„Ÿå™¨æ—¶å®šä¹‰çš„åç§°ã€‚*

### **ç¬¬4èŠ‚ï¼šæ‚¨çš„ç¬¬ä¸€æ¬¡äº¤äº’å¼ä»¿çœŸ**

æœ¬èŠ‚å°†é€šè¿‡ä¸€ä¸ªå®Œæ•´çš„åŠ¨æ‰‹æ•™ç¨‹ï¼ŒæŒ‡å¯¼æ‚¨å¯åŠ¨ç¯å¢ƒã€å¯è§†åŒ–æ•°æ®å¹¶æ‰‹åŠ¨æ§åˆ¶è½¦è¾†ï¼Œä»è€Œå°†å‰é¢ä»‹ç»çš„ç†è®ºçŸ¥è¯†ä»˜è¯¸å®è·µã€‚

#### **4.1 å¯åŠ¨ç¯å¢ƒ**

è¯·æ‰“å¼€ä¸‰ä¸ªç‹¬ç«‹çš„ç»ˆç«¯ï¼Œå¹¶æŒ‰é¡ºåºæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š

**ç»ˆç«¯ 1: å¯åŠ¨CARLAæœåŠ¡å™¨**

Bash

\# å¯¼èˆªåˆ°CARLAå®‰è£…ç›®å½•  
cd \~/carla\_simulator

\# å¯åŠ¨ä»¿çœŸå™¨ã€‚-quality-level=Low å¯ä»¥é™ä½å¯¹GPUçš„è¦æ±‚  
./CarlaUE4.sh \-quality-level=Low

æ‚¨åº”è¯¥ä¼šçœ‹åˆ°ä¸€ä¸ªCARLAä»¿çœŸçª—å£å¼¹å‡ºï¼Œæ˜¾ç¤ºä¸€ä¸ªé»˜è®¤çš„åŸé•‡åœ°å›¾ã€‚

**ç»ˆç«¯ 2: å¯åŠ¨carla-ros-bridge**

Bash

\# å¯¼èˆªåˆ°æ‚¨çš„colconå·¥ä½œç©ºé—´  
cd \~/carla\_ws

\# sourceå·¥ä½œç©ºé—´çš„ç¯å¢ƒ  
source install/setup.bash

\# å¯åŠ¨æ¡¥æ¥å™¨ï¼Œå¹¶æŒ‡å®šåŸé•‡åœ°å›¾å’ŒåŒæ­¥æ¨¡å¼  
ros2 launch carla\_ros\_bridge carla\_ros\_bridge.launch.py town:=Town04 synchronous\_mode:=true

è¿™ä¸ªå‘½ä»¤ä¼šå¯åŠ¨æ ¸å¿ƒçš„æ¡¥æ¥èŠ‚ç‚¹ï¼Œå®ƒå°†è¿æ¥åˆ°CARLAæœåŠ¡å™¨å¹¶å¼€å§‹å‘å¸ƒä¸–ç•Œä¿¡æ¯ã€‚

**ç»ˆç«¯ 3: ç”Ÿæˆä¸»è½¦ (Ego Vehicle)**

Bash

\# å¯¼èˆªåˆ°æ‚¨çš„colconå·¥ä½œç©ºé—´  
cd \~/carla\_ws

\# sourceå·¥ä½œç©ºé—´çš„ç¯å¢ƒ  
source install/setup.bash

\# ä½¿ç”¨é¢„å®šä¹‰çš„é…ç½®æ–‡ä»¶ç”Ÿæˆä¸€è¾†å¸¦æœ‰ä¼ æ„Ÿå™¨çš„è½¦è¾†  
ros2 launch carla\_spawn\_objects carla\_example\_ego\_vehicle.launch.py

æ‰§è¡Œæ­¤å‘½ä»¤åï¼Œæ‚¨å°†åœ¨CARLAçª—å£ä¸­çœ‹åˆ°ä¸€è¾†æ–°çš„ä¸»è½¦è¢«ç”Ÿæˆï¼Œå¹¶é…å¤‡äº†ä¸€å¥—é»˜è®¤çš„ä¼ æ„Ÿå™¨ï¼ˆé€šå¸¸åŒ…æ‹¬æ‘„åƒå¤´ã€æ¿€å…‰é›·è¾¾å’ŒIMUï¼‰21ã€‚

#### **4.2 ä½¿ç”¨RVizè¿›è¡Œå¯è§†åŒ–**

RVizæ˜¯ROSä¸­åŠŸèƒ½å¼ºå¤§çš„3Då¯è§†åŒ–å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©æ‚¨ç›´è§‚åœ°ç†è§£ä»¿çœŸç¯å¢ƒä¸­å‘ç”Ÿçš„ä¸€åˆ‡ã€‚

**ç»ˆç«¯ 4: å¯åŠ¨RViz**

Bash

\# å¯åŠ¨RViz2  
rviz2

åœ¨RVizçª—å£ä¸­ï¼Œæ‚¨å¯ä»¥æ·»åŠ ä¸åŒç±»å‹çš„æ˜¾ç¤ºæ’ä»¶æ¥è®¢é˜…å’Œå¯è§†åŒ–ROSè¯é¢˜ï¼š

1. **æ·»åŠ TFï¼š** ç‚¹å‡»å·¦ä¸‹è§’çš„â€œAddâ€æŒ‰é’®ï¼Œé€‰æ‹©â€œTFâ€ã€‚è¿™å°†æ˜¾ç¤ºåæ ‡ç³»è½¬æ¢æ ‘ï¼Œè®©æ‚¨å¯ä»¥çœ‹åˆ°è½¦è¾†å’Œå„ä¸ªä¼ æ„Ÿå™¨ä¹‹é—´çš„ç›¸å¯¹ä½ç½®å…³ç³» 17ã€‚ç¡®ä¿å°†â€œGlobal Optionsâ€ä¸­çš„â€œFixed Frameâ€è®¾ç½®ä¸ºmapã€‚  
2. **æ·»åŠ æ¿€å…‰é›·è¾¾ç‚¹äº‘ï¼š** ç‚¹å‡»â€œAddâ€ï¼Œé€‰æ‹©â€œPointCloud2â€ã€‚åœ¨â€œTopicâ€å­—æ®µä¸­ï¼Œé€‰æ‹©/carla/ego\_vehicle/lidar/lidar1/point\_cloudã€‚æ‚¨å°†åœ¨RVizä¸­çœ‹åˆ°è½¦è¾†å‘¨å›´çš„3Dç‚¹äº‘ã€‚  
3. **æ·»åŠ æ‘„åƒå¤´å›¾åƒï¼š** ç‚¹å‡»â€œAddâ€ï¼Œé€‰æ‹©â€œImageâ€ã€‚åœ¨â€œTopicâ€å­—æ®µä¸­ï¼Œé€‰æ‹©/carla/ego\_vehicle/camera/rgb/front/image\_colorã€‚æ‚¨å°†çœ‹åˆ°ä¸€ä¸ªæ˜¾ç¤ºè½¦è¾†å‰è§†æ‘„åƒå¤´ç”»é¢çš„çª—å£ã€‚  
4. **æ·»åŠ ç›®æ ‡è¾¹ç•Œæ¡†ï¼š** ç‚¹å‡»â€œAddâ€ï¼Œé€‰æ‹©â€œMarkerArrayâ€ã€‚åœ¨â€œTopicâ€å­—æ®µä¸­ï¼Œé€‰æ‹©/carla/objectsã€‚å¦‚æœåœºæ™¯ä¸­æœ‰å…¶ä»–è½¦è¾†æˆ–è¡Œäººï¼Œæ‚¨å°†çœ‹åˆ°ä»£è¡¨å®ƒä»¬çš„3Dè¾¹ç•Œæ¡†ã€‚

#### **4.3 é€šè¿‡ROSè¿›è¡Œæ‰‹åŠ¨æ§åˆ¶**

ç°åœ¨ï¼Œè®©æˆ‘ä»¬é€šè¿‡ROSæ¥æ§åˆ¶åˆšåˆšç”Ÿæˆçš„ä¸»è½¦ã€‚

**æ–¹æ³•ä¸€ï¼šä½¿ç”¨carla\_manual\_controlåŒ…**

è¿™ä¸ªåŒ…æä¾›äº†ä¸€ä¸ªæ–¹ä¾¿çš„ç”¨æˆ·ç•Œé¢ã€‚

Bash

\# åœ¨ä¸€ä¸ªæ–°çš„ç»ˆç«¯ä¸­æ‰§è¡Œ  
cd \~/carla\_ws  
source install/setup.bash  
ros2 launch carla\_manual\_control carla\_manual\_control.launch.py

è¿™å°†å¯åŠ¨ä¸€ä¸ªPyGameçª—å£ï¼Œæ˜¾ç¤ºå‰è§†æ‘„åƒå¤´å›¾åƒã€‚æ‚¨å¯ä»¥ä½¿ç”¨W, A, S, Dé”®æ¥æ§åˆ¶è½¦è¾†çš„æ²¹é—¨ã€åˆ¹è½¦å’Œè½¬å‘ 9ã€‚

**æ–¹æ³•äºŒï¼šç›´æ¥ä»å‘½ä»¤è¡Œå‘å¸ƒæ§åˆ¶æŒ‡ä»¤**

ä¸ºäº†æ›´æ·±å…¥åœ°ç†è§£å…¶åº•å±‚æœºåˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ROS 2çš„å‘½ä»¤è¡Œå·¥å…·å‘æ§åˆ¶è¯é¢˜å‘å¸ƒæ¶ˆæ¯ã€‚

Bash

\# åœ¨ä¸€ä¸ªæ–°çš„ç»ˆç«¯ä¸­ï¼Œå‘å¸ƒä¸€ä¸ªä½¿è½¦è¾†ç¼“æ…¢ç›´è¡Œçš„æŒ‡ä»¤  
\# è®©è½¦è¾†ä»¥50%çš„æ²¹é—¨ç›´è¡Œ  
ros2 topic pub \--once /carla/ego\_vehicle/vehicle\_control\_cmd carla\_msgs/msg/CarlaEgoVehicleControl "{throttle: 0.5, steer: 0.0, brake: 0.0}"

\# å‘å¸ƒä¸€ä¸ªä½¿è½¦è¾†å³è½¬çš„æŒ‡ä»¤  
\# è®©è½¦è¾†ä»¥30%çš„æ²¹é—¨ï¼Œ20%çš„å¹…åº¦å‘å³è½¬å‘  
ros2 topic pub \--once /carla/ego\_vehicle/vehicle\_control\_cmd carla\_msgs/msg/CarlaEgoVehicleControl "{throttle: 0.3, steer: 0.2, brake: 0.0}"

é€šè¿‡æ‰§è¡Œè¿™äº›å‘½ä»¤ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°è½¦è¾†åœ¨CARLAä»¿çœŸå™¨ä¸­åšå‡ºç›¸åº”çš„åŠ¨ä½œã€‚è¿™æ¸…æ™°åœ°å±•ç¤ºäº†ROSèŠ‚ç‚¹å¦‚ä½•é€šè¿‡å‘å¸ƒæ¶ˆæ¯æ¥æ§åˆ¶ä»¿çœŸä¸­çš„å‚ä¸è€…ï¼Œè¿™æ˜¯æ„å»ºä»»ä½•è‡ªåŠ¨é©¾é©¶åŠŸèƒ½çš„åŸºç¡€ 5ã€‚

---

## **ç¬¬ä¸‰éƒ¨åˆ†ï¼šADASå¼€å‘å…¥é—¨**

æœ¬éƒ¨åˆ†æ˜¯æŠ¥å‘Šçš„æ ¸å¿ƒï¼Œæ—¨åœ¨æ»¡è¶³ç”¨æˆ·å¯¹å®ç°ç®€å•ADASåŠŸèƒ½çš„è¯·æ±‚ã€‚å®ƒå°†ç†è®ºä¸å®è·µç›¸ç»“åˆï¼Œå±•ç¤ºå¦‚ä½•åœ¨ROSä¸­æ„å»ºä¸CARLAç¯å¢ƒäº¤äº’çš„æ„ŸçŸ¥å’Œæ§åˆ¶èŠ‚ç‚¹ã€‚

### **ç¬¬5èŠ‚ï¼šå®ç°æ¨ªå‘æ§åˆ¶ï¼šè½¦é“ä¿æŒè¾…åŠ©ï¼ˆLKAï¼‰**

è½¦é“ä¿æŒè¾…åŠ©ï¼ˆLane Keeping Assist, LKAï¼‰æ˜¯ä¸€é¡¹åŸºæœ¬çš„ADASåŠŸèƒ½ï¼Œå…¶ç›®æ ‡æ˜¯è‡ªåŠ¨æ§åˆ¶è½¦è¾†çš„è½¬å‘ï¼Œä½¿å…¶ä¿æŒåœ¨å½“å‰è½¦é“å†…è¡Œé©¶ã€‚ä¸€ä¸ªå®Œæ•´çš„LKAç³»ç»Ÿé€šå¸¸ç”±æ„ŸçŸ¥æ¨¡å—å’Œæ§åˆ¶æ¨¡å—ç»„æˆã€‚

#### **5.1 ç†è®ºåŸºç¡€**

**1\. æ„ŸçŸ¥ï¼šåŸºäºè®¡ç®—æœºè§†è§‰çš„è½¦é“çº¿æ£€æµ‹**

æ„ŸçŸ¥æ¨¡å—çš„ä»»åŠ¡æ˜¯ä»è½¦è½½æ‘„åƒå¤´è·å–çš„å›¾åƒä¸­æ£€æµ‹å‡ºè½¦é“çº¿çš„ä½ç½®ã€‚ä¸€ä¸ªç»å…¸çš„ã€ä¸ä¾èµ–æ·±åº¦å­¦ä¹ çš„è®¡ç®—æœºè§†è§‰æµç¨‹å¦‚ä¸‹ 23ï¼š

* **ç°åº¦è½¬æ¢ (Grayscale Conversion):** å°†ä¸‰é€šé“çš„RGBå›¾åƒè½¬æ¢ä¸ºå•é€šé“çš„ç°åº¦å›¾åƒï¼Œä»¥å‡å°‘è®¡ç®—é‡ 23ã€‚  
* **é«˜æ–¯æ¨¡ç³Š (Gaussian Blur):** å¯¹å›¾åƒè¿›è¡Œå¹³æ»‘å¤„ç†ï¼Œä»¥å»é™¤å™ªå£°ï¼Œé¿å…åœ¨åç»­æ­¥éª¤ä¸­äº§ç”Ÿé”™è¯¯çš„è¾¹ç¼˜æ£€æµ‹ç»“æœ 23ã€‚  
* **Cannyè¾¹ç¼˜æ£€æµ‹ (Canny Edge Detection):** è¿™æ˜¯ä¸€ç§å¤šé˜¶æ®µçš„è¾¹ç¼˜æ£€æµ‹ç®—æ³•ï¼Œèƒ½å¤Ÿæœ‰æ•ˆåœ°è¯†åˆ«å›¾åƒä¸­å¼ºåº¦å˜åŒ–å‰§çƒˆçš„åŒºåŸŸï¼ˆå³è¾¹ç¼˜ï¼‰26ã€‚  
* **æ„Ÿå…´è¶£åŒºåŸŸæ©ç  (Region of Interest Masking):** æ‘„åƒå¤´å›¾åƒä¸­åŒ…å«äº†å¤©ç©ºã€è·¯è¾¹å»ºç­‘ç­‰ä¸è½¦é“çº¿æ— å…³çš„åŒºåŸŸã€‚é€šè¿‡å®šä¹‰ä¸€ä¸ªå¤šè¾¹å½¢ï¼ˆé€šå¸¸æ˜¯æ¢¯å½¢ï¼‰æ¥æ¡†é€‰å‡ºè·¯é¢åŒºåŸŸï¼Œå¯ä»¥å±è”½æ‰æ— å…³ä¿¡æ¯ï¼Œæé«˜åç»­å¤„ç†çš„å‡†ç¡®æ€§å’Œæ•ˆç‡ 23ã€‚  
* **éœå¤«å˜æ¢ (Hough Transform):** ç»è¿‡ä¸Šè¿°å¤„ç†åï¼Œå›¾åƒä¸­å‰©ä¸‹çš„æ˜¯ä»£è¡¨è½¦é“çº¿çš„è¾¹ç¼˜åƒç´ ç‚¹ã€‚éœå¤«å˜æ¢æ˜¯ä¸€ç§ç‰¹å¾æå–æŠ€æœ¯ï¼Œå¯ä»¥å°†å›¾åƒç©ºé—´ä¸­çš„ç›´çº¿ï¼ˆæˆ–å…¶ä»–å½¢çŠ¶ï¼‰æ˜ å°„åˆ°å‚æ•°ç©ºé—´ä¸­çš„ç‚¹ã€‚é€šè¿‡åœ¨å‚æ•°ç©ºé—´ä¸­å¯»æ‰¾å³°å€¼ï¼Œå¯ä»¥æœ‰æ•ˆåœ°æ£€æµ‹å‡ºå›¾åƒä¸­çš„ç›´çº¿æ®µï¼Œä»è€Œè¯†åˆ«å‡ºè½¦é“çº¿ 24ã€‚

**2\. æ§åˆ¶ï¼šå‡ ä½•è·¯å¾„è·Ÿè¸ªæ§åˆ¶å™¨**

æ§åˆ¶æ¨¡å—æ ¹æ®æ„ŸçŸ¥æ¨¡å—æä¾›çš„è½¦é“çº¿ä¿¡æ¯ï¼Œè®¡ç®—å‡ºä½¿è½¦è¾†æ²¿è½¦é“ä¸­å¿ƒè¡Œé©¶æ‰€éœ€çš„è½¬å‘æŒ‡ä»¤ã€‚ä¸¤ç§ç»å…¸çš„å‡ ä½•æ§åˆ¶å™¨æ˜¯ï¼š

* **çº¯è·Ÿè¸ªæ§åˆ¶å™¨ (Pure Pursuit):** è¯¥ç®—æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯â€œè¿½é€â€å‰æ–¹è·¯å¾„ä¸Šçš„ä¸€ä¸ªâ€œé¢„ç„ç‚¹â€ï¼ˆlook-ahead pointï¼‰ã€‚æ§åˆ¶å™¨è®¡ç®—å‡ºä¸€ä¸ªåœ†å¼§ï¼Œè¯¥åœ†å¼§çš„æ›²ç‡å¯ä»¥ä½¿è½¦è¾†ä»å½“å‰ä½ç½®æ­£å¥½ç»è¿‡è¿™ä¸ªé¢„ç„ç‚¹ã€‚é¢„ç„ç‚¹ä¸è½¦è¾†ä¹‹é—´çš„è·ç¦»ï¼ˆé¢„ç„è·ç¦»ï¼‰æ˜¯ä¸€ä¸ªå…³é”®çš„è°ƒèŠ‚å‚æ•°ï¼šè¾ƒå°çš„é¢„ç„è·ç¦»ä¼šä½¿è½¦è¾†æ›´æ¿€è¿›åœ°å›å½’è·¯å¾„ï¼Œä½†å¯èƒ½å¯¼è‡´è¶…è°ƒå’ŒæŒ¯è¡ï¼›è¾ƒå¤§çš„é¢„ç„è·ç¦»åˆ™ä¼šä½¿è¡Œé©¶è½¨è¿¹æ›´å¹³æ»‘ï¼Œä½†åœ¨å¼¯é“å¤„çš„è·¯å¾„è·Ÿè¸ªè¯¯å·®å¯èƒ½æ›´å¤§ 28ã€‚  
* **Stanleyæ§åˆ¶å™¨:** è¿™ç§æ§åˆ¶å™¨åŒæ—¶è€ƒè™‘äº†ä¸¤ä¸ªè¯¯å·®ï¼šæ¨ªå‘è¯¯å·®ï¼ˆcrosstrack errorï¼‰ï¼Œå³è½¦è¾†å‰è½´ä¸­å¿ƒåˆ°æœ€è¿‘è·¯å¾„ç‚¹çš„å‚ç›´è·ç¦»ï¼›ä»¥åŠèˆªå‘è¯¯å·®ï¼ˆheading errorï¼‰ï¼Œå³è½¦è¾†çš„èˆªå‘ä¸è·¯å¾„åˆ‡çº¿æ–¹å‘ä¹‹é—´çš„å¤¹è§’ã€‚Stanleyæ§åˆ¶å¾‹é€šè¿‡ä¸€ä¸ªç»¼åˆå…¬å¼ï¼Œå°†è¿™ä¸¤ä¸ªè¯¯å·®ç»“åˆèµ·æ¥è®¡ç®—å‡ºæ‰€éœ€çš„è½¬å‘è§’ï¼Œé€šå¸¸åœ¨è¾ƒé«˜é€Ÿåº¦ä¸‹è¡¨ç°å¾—æ¯”çº¯è·Ÿè¸ªæ›´ç¨³å®š 31ã€‚

#### **5.2 ROSä¸­çš„å®è·µå®ç°**

åœ¨ROSä¸­ï¼Œä¸€ä¸ªå®Œæ•´çš„LKAç³»ç»Ÿè¢«å®ç°ä¸ºä¸€ä¸ªç”±å¤šä¸ªèŠ‚ç‚¹ç»„æˆçš„æµæ°´çº¿ï¼ˆpipelineï¼‰ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ†æåƒErendrgnl/Carla-Ros-Lane-Keeping-System 34è¿™æ ·çš„å¼€æºé¡¹ç›®æˆ–paulyehtw/Lane-Keeping-Assist-on-CARLA 35ä¸­çš„æ¦‚å¿µæ¥ç†è§£å…¶æ¶æ„ã€‚

ä¸€ä¸ªå…¸å‹çš„LKAç³»ç»ŸROSæ¶æ„å¦‚ä¸‹ï¼š

1. **æ„ŸçŸ¥èŠ‚ç‚¹ (/perception\_node):**  
   * **è®¢é˜…:** è®¢é˜…æ¥è‡ªcarla-ros-bridgeçš„æ‘„åƒå¤´å›¾åƒè¯é¢˜ï¼Œä¾‹å¦‚/carla/ego\_vehicle/camera/rgb/front/image\_colorã€‚  
   * **å¤„ç†:** åœ¨å›è°ƒå‡½æ•°ä¸­ï¼Œè¯¥èŠ‚ç‚¹æ‰§è¡Œä¸Šä¸€èŠ‚æè¿°çš„OpenCVè®¡ç®—æœºè§†è§‰æµç¨‹ã€‚å®ƒå°†ROSçš„sensor\_msgs/Imageæ¶ˆæ¯è½¬æ¢ä¸ºOpenCVå›¾åƒæ ¼å¼ï¼Œè¿›è¡Œè½¦é“çº¿æ£€æµ‹ã€‚  
   * **å‘å¸ƒ:** å¤„ç†çš„ç»“æœä¸æ˜¯ç®€å•çš„å›¾åƒï¼Œè€Œæ˜¯å¯¹è½¦è¾†æ§åˆ¶æœ‰ç”¨çš„ä¿¡æ¯ï¼Œä¾‹å¦‚è®¡ç®—å‡ºçš„è½¦é“ä¸­å¿ƒçº¿çš„å¤šé¡¹å¼ç³»æ•°ï¼Œæˆ–è€…ä¸€ä¸ªç›®æ ‡è·¯å¾„ç‚¹ã€‚è¿™äº›ä¿¡æ¯è¢«å‘å¸ƒåˆ°ä¸€ä¸ªè‡ªå®šä¹‰çš„è¯é¢˜ä¸Šï¼Œä¾‹å¦‚/lka/target\_pathã€‚  
2. **æ§åˆ¶èŠ‚ç‚¹ (/control\_node):**  
   * **è®¢é˜…:** è®¢é˜…æ„ŸçŸ¥èŠ‚ç‚¹å‘å¸ƒçš„/lka/target\_pathè¯é¢˜ï¼Œä»¥åŠè½¦è¾†çš„å½“å‰çŠ¶æ€ï¼ˆå¦‚ä½ç½®å’Œé€Ÿåº¦ï¼‰ï¼Œé€šå¸¸æ¥è‡ª/carla/ego\_vehicle/odometryè¯é¢˜ã€‚  
   * **å¤„ç†:** è¯¥èŠ‚ç‚¹å®ç°äº†Stanleyæˆ–Pure Pursuitæ§åˆ¶ç®—æ³•ã€‚å®ƒæ ¹æ®è®¢é˜…åˆ°çš„ç›®æ ‡è·¯å¾„å’Œè½¦è¾†å½“å‰çŠ¶æ€ï¼Œè®¡ç®—å‡ºä¸ºäº†è·Ÿè¸ªè¯¥è·¯å¾„æ‰€éœ€è¦çš„è½¬å‘è§’ã€‚  
   * **å‘å¸ƒ:** æœ€åï¼Œæ§åˆ¶èŠ‚ç‚¹å°†è®¡ç®—å‡ºçš„æ§åˆ¶æŒ‡ä»¤ï¼ˆåŒ…å«è½¬å‘è§’å’Œé¢„è®¾çš„æ²¹é—¨/é€Ÿåº¦å€¼ï¼‰æ‰“åŒ…æˆä¸€ä¸ªcarla\_msgs/CarlaEgoVehicleControlæˆ–ackermann\_msgs/AckermannDriveæ¶ˆæ¯ï¼Œå¹¶å‘å¸ƒåˆ°carla-ros-bridgeç›‘å¬çš„ç›¸åº”æ§åˆ¶è¯é¢˜ä¸Šï¼ˆä¾‹å¦‚/carla/ego\_vehicle/vehicle\_control\_cmdï¼‰ï¼Œä»è€Œé—­åˆæ•´ä¸ªæ§åˆ¶ç¯è·¯ï¼Œä½¿è½¦è¾†åœ¨CARLAä¸­å®ç°è‡ªåŠ¨è½¬å‘ã€‚

**ä»£ç ç‰‡æ®µç¤ºä¾‹ (Python \- æ„ŸçŸ¥èŠ‚ç‚¹):**

Python

import rclpy  
from rclpy.node import Node  
from sensor\_msgs.msg import Image  
from cv\_bridge import CvBridge  
import cv2  
import numpy as np

class LaneDetectionNode(Node):  
    def \_\_init\_\_(self):  
        super().\_\_init\_\_('lane\_detection\_node')  
        self.subscription \= self.create\_subscription(  
            Image,  
            '/carla/ego\_vehicle/camera/rgb/front/image\_color',  
            self.image\_callback,  
            10)  
        self.bridge \= CvBridge()

    def image\_callback(self, msg):  
        cv\_image \= self.bridge.imgmsg\_to\_cv2(msg, "bgr8")  
          
        \# 1\. ç°åº¦è½¬æ¢å’Œé«˜æ–¯æ¨¡ç³Š  
        gray \= cv2.cvtColor(cv\_image, cv2.COLOR\_BGR2GRAY)  
        blur \= cv2.GaussianBlur(gray, (5, 5), 0)  
          
        \# 2\. Cannyè¾¹ç¼˜æ£€æµ‹  
        edges \= cv2.Canny(blur, 50, 150)  
          
        \# 3\. æ„Ÿå…´è¶£åŒºåŸŸæ©ç   
        height, width \= edges.shape  
        mask \= np.zeros\_like(edges)  
        polygon \= np.array(\[\[(0, height), (width, height), (width // 2, height // 2)\]\], np.int32)  
        cv2.fillPoly(mask, polygon, 255)  
        masked\_edges \= cv2.bitwise\_and(edges, mask)  
          
        \# 4\. éœå¤«å˜æ¢æ£€æµ‹ç›´çº¿  
        lines \= cv2.HoughLinesP(masked\_edges, 2, np.pi / 180, 100, np.array(), minLineLength=40, maxLineGap=5)  
          
        \#... åç»­å¤„ç†ï¼šå¹³å‡/æ‹Ÿåˆè½¦é“çº¿ï¼Œè®¡ç®—ç›®æ ‡è·¯å¾„...  
        \#... å‘å¸ƒç›®æ ‡è·¯å¾„åˆ° /lka/target\_path...

### **ç¬¬6èŠ‚ï¼šå®ç°çºµå‘æ§åˆ¶ï¼šACCä¸AEB**

çºµå‘æ§åˆ¶ä¸»è¦å…³æ³¨è½¦è¾†å‰åæ–¹å‘çš„è¿åŠ¨ï¼ŒåŒ…æ‹¬é€Ÿåº¦æ§åˆ¶å’Œç¢°æ’é¿å…ã€‚è‡ªé€‚åº”å·¡èˆªæ§åˆ¶ï¼ˆACCï¼‰å’Œè‡ªåŠ¨ç´§æ€¥åˆ¶åŠ¨ï¼ˆAEBï¼‰æ˜¯ä¸¤é¡¹å…³é”®çš„çºµå‘æ§åˆ¶åŠŸèƒ½ã€‚

#### **6.1 ç†è®ºåŸºç¡€**

**1\. è‡ªé€‚åº”å·¡èˆªæ§åˆ¶ (Adaptive Cruise Control, ACC):**

ACCæ˜¯ä¼ ç»Ÿå·¡èˆªæ§åˆ¶çš„å‡çº§ç‰ˆï¼Œå®ƒä¸ä»…èƒ½ä¿æŒè®¾å®šçš„é€Ÿåº¦ï¼Œè¿˜èƒ½åœ¨æ£€æµ‹åˆ°å‰æ–¹æœ‰è¾ƒæ…¢è½¦è¾†æ—¶è‡ªåŠ¨å‡é€Ÿï¼Œä¸å‰è½¦ä¿æŒä¸€ä¸ªå®‰å…¨è·ç¦»ã€‚å½“é“è·¯é€šç•…æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨åŠ é€Ÿå›åˆ°è®¾å®šé€Ÿåº¦ã€‚å®ç°ACCçš„æ ¸å¿ƒæ˜¯**PIDæ§åˆ¶å™¨** 36ã€‚

PIDï¼ˆProportional-Integral-Derivativeï¼Œæ¯”ä¾‹-ç§¯åˆ†-å¾®åˆ†ï¼‰æ§åˆ¶å™¨æ˜¯ä¸€ç§ç»å…¸çš„åé¦ˆæ§åˆ¶ç®—æ³•ã€‚å®ƒé€šè¿‡è®¡ç®—å½“å‰å€¼ä¸æœŸæœ›å€¼ä¹‹é—´çš„â€œè¯¯å·®â€ï¼Œå¹¶ç»“åˆæ¯”ä¾‹ã€ç§¯åˆ†ã€å¾®åˆ†ä¸‰ä¸ªéƒ¨åˆ†æ¥ç”Ÿæˆæ§åˆ¶è¾“å‡ºï¼Œä»¥æœ€å°åŒ–è¿™ä¸ªè¯¯å·® 37ã€‚

* **æ¯”ä¾‹(P)é¡¹:** æ§åˆ¶ä½œç”¨ä¸å½“å‰è¯¯å·®æˆæ­£æ¯”ã€‚è¯¯å·®è¶Šå¤§ï¼Œæ§åˆ¶è¾“å‡ºè¶Šå¼ºã€‚å®ƒæä¾›æœ€åŸºæœ¬çš„æ§åˆ¶å“åº” 38ã€‚  
* **ç§¯åˆ†(I)é¡¹:** ç´¯ç§¯è¿‡å»çš„è¯¯å·®ã€‚å¦‚æœç³»ç»Ÿå­˜åœ¨æŒç»­çš„ç¨³æ€è¯¯å·®ï¼ˆä¾‹å¦‚ï¼Œç”±äºé£é˜»æˆ–å¡åº¦å¯¼è‡´è½¦è¾†é€Ÿåº¦å§‹ç»ˆç•¥ä½äºè®¾å®šå€¼ï¼‰ï¼Œç§¯åˆ†é¡¹ä¼šä¸æ–­å¢å¤§ï¼Œç›´åˆ°è¯¯å·®è¢«æ¶ˆé™¤ 38ã€‚  
* **å¾®åˆ†(D)é¡¹:** å“åº”è¯¯å·®çš„å˜åŒ–ç‡ã€‚å®ƒèƒ½é¢„æµ‹è¯¯å·®çš„æœªæ¥è¶‹åŠ¿ï¼Œå¹¶æå‰åšå‡ºååº”ï¼Œä»¥é˜²æ­¢è¶…è°ƒå’ŒæŒ¯è¡ï¼Œä½¿ç³»ç»Ÿå“åº”æ›´å¹³ç¨³ 38ã€‚

åœ¨ACCä¸­ï¼Œè¯¯å·®å¯ä»¥æ˜¯â€œæœŸæœ›è·Ÿè½¦è·ç¦»â€ä¸â€œå®é™…è·Ÿè½¦è·ç¦»â€ä¹‹å·®ï¼ŒPIDæ§åˆ¶å™¨çš„è¾“å‡ºåˆ™å¯¹åº”äºè½¦è¾†çš„æ²¹é—¨æˆ–åˆ¹è½¦æŒ‡ä»¤ã€‚

**2\. è‡ªåŠ¨ç´§æ€¥åˆ¶åŠ¨ (Automatic Emergency Braking, AEB):**

AEBç³»ç»Ÿåœ¨æ£€æµ‹åˆ°å³å°†å‘ç”Ÿç¢°æ’ä¸”é©¾é©¶å‘˜æ²¡æœ‰é‡‡å–è¡ŒåŠ¨æ—¶ï¼Œä¼šè‡ªåŠ¨æ–½åŠ åˆ¶åŠ¨ä»¥é¿å…æˆ–å‡è½»ç¢°æ’ã€‚AEBå†³ç­–çš„æ ¸å¿ƒæŒ‡æ ‡æ˜¯**ç¢°æ’æ—¶é—´ (Time-to-Collision, TTC)** 39ã€‚

TTCçš„è®¡ç®—éå¸¸ç›´è§‚ï¼š

$$TTC \= \\frac{\\text{ç›¸å¯¹è·ç¦»}}{\\text{ç›¸å¯¹é€Ÿåº¦}}$$

å…¶ä¸­ï¼Œç›¸å¯¹è·ç¦»æ˜¯æœ¬è½¦ä¸å‰æ–¹éšœç¢ç‰©ä¹‹é—´çš„è·ç¦»ï¼Œç›¸å¯¹é€Ÿåº¦æ˜¯ä¸¤è€…çš„é€Ÿåº¦å·®ã€‚TTCçš„ç‰©ç†æ„ä¹‰æ˜¯ï¼Œå¦‚æœä¸¤è€…éƒ½ä¿æŒå½“å‰é€Ÿåº¦ä¸å˜ï¼Œå°†åœ¨å¤šé•¿æ—¶é—´åå‘ç”Ÿç¢°æ’ã€‚AEBç³»ç»Ÿä¼šè®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªTTCé˜ˆå€¼ã€‚å½“è®¡ç®—å‡ºçš„TTCä½äºæŸä¸ªé˜ˆå€¼æ—¶ï¼ˆä¾‹å¦‚ï¼Œ2.0ç§’ï¼‰ï¼Œç³»ç»Ÿä¼šè§¦å‘åˆ¶åŠ¨ 40ã€‚

#### **6.2 ROSä¸­çš„å®è·µå®ç°**

ACCå’ŒAEBçš„å®ç°åŒæ ·éµå¾ªROSçš„æ¨¡å—åŒ–æ€æƒ³ã€‚è™½ç„¶ç®€å•çš„AEBå¯ä»¥ä»…ä¾èµ–æ¿€å…‰é›·è¾¾ï¼Œä½†ç¨³å¥çš„ç³»ç»Ÿé€šå¸¸éœ€è¦èåˆå¤šç§ä¼ æ„Ÿå™¨çš„æ•°æ®ã€‚æˆ‘ä»¬å°†åˆ†æä½¿ç”¨æ¿€å…‰é›·è¾¾æˆ–é›·è¾¾è·å–å‰æ–¹è½¦è¾†è·ç¦»å’Œç›¸å¯¹é€Ÿåº¦çš„é¡¹ç›® 42ã€‚

ä¸€ä¸ªå…¸å‹çš„AEB/ACCç³»ç»ŸROSæ¶æ„å¦‚ä¸‹ï¼š

1. **æ„ŸçŸ¥èŠ‚ç‚¹ (/perception\_node):**  
   * **è®¢é˜…:** è®¢é˜…æ¿€å…‰é›·è¾¾ç‚¹äº‘è¯é¢˜ (/carla/ego\_vehicle/lidar/front/point\_cloud) å’Œ/æˆ–æœ¬è½¦çš„é‡Œç¨‹è®¡è¯é¢˜ (/carla/ego\_vehicle/odometry)ã€‚  
   * **å¤„ç†:**  
     * å¤„ç†ç‚¹äº‘æ•°æ®ï¼Œä»¥è¯†åˆ«æ­£å‰æ–¹çš„éšœç¢ç‰©ï¼ˆé€šå¸¸æ˜¯å¯»æ‰¾è·¯å¾„ä¸Šæœ€è¿‘çš„ç‚¹ç°‡ï¼‰ï¼Œå¹¶è®¡ç®—å‡º**ç›¸å¯¹è·ç¦»**ã€‚  
     * é€šè¿‡è®¢é˜…æœ¬è½¦çš„é‡Œç¨‹è®¡ä¿¡æ¯è·å–**æœ¬è½¦é€Ÿåº¦**ã€‚  
     * ä¸ºäº†è®¡ç®—**ç›¸å¯¹é€Ÿåº¦**ï¼Œå¯ä»¥é€šè¿‡å¯¹å‰æ–¹éšœç¢ç‰©çš„ä½ç½®è¿›è¡Œæ—¶é—´ä¸Šçš„å·®åˆ†æ¥ä¼°ç®—å…¶é€Ÿåº¦ï¼Œæˆ–è€…æ›´ç®€å•åœ°ï¼Œä»/carla/objectsçœŸå€¼è¯é¢˜ä¸­ç›´æ¥è·å–å‰æ–¹è½¦è¾†çš„é€Ÿåº¦ä¿¡æ¯ã€‚  
   * **å‘å¸ƒ:** å°†è®¡ç®—å‡ºçš„å…³é”®ä¿¡æ¯ï¼ˆå¦‚ç›¸å¯¹è·ç¦»ã€ç›¸å¯¹é€Ÿåº¦ï¼‰å‘å¸ƒåˆ°ä¸€ä¸ªè‡ªå®šä¹‰è¯é¢˜ï¼Œä¾‹å¦‚/lead\_vehicle\_statusã€‚  
2. **AEBèŠ‚ç‚¹ (/aeb\_node):**  
   * **è®¢é˜…:** è®¢é˜…/lead\_vehicle\_statusè¯é¢˜ã€‚  
   * **å¤„ç†:** åœ¨å›è°ƒå‡½æ•°ä¸­ï¼Œæ ¹æ®æ¥æ”¶åˆ°çš„ç›¸å¯¹è·ç¦»å’Œç›¸å¯¹é€Ÿåº¦è®¡ç®—TTCã€‚  
   * **å†³ç­–ä¸å‘å¸ƒ:** å¦‚æœTTCå°äºé¢„è®¾çš„å®‰å…¨é˜ˆå€¼ï¼ˆä¾‹å¦‚ï¼Œ1.5ç§’ï¼‰ï¼Œè¯¥èŠ‚ç‚¹ä¼šç«‹å³å‘å¸ƒä¸€ä¸ªæœ€å¤§åˆ¹è½¦æŒ‡ä»¤ï¼ˆbrake: 1.0ï¼‰åˆ°/carla/ego\_vehicle/vehicle\_control\_cmdè¯é¢˜ï¼Œä»¥æ‰§è¡Œç´§æ€¥åˆ¶åŠ¨ã€‚  
3. **ACCèŠ‚ç‚¹ (/acc\_node):**  
   * **è®¢é˜…:** åŒæ ·è®¢é˜…/lead\_vehicle\_statusè¯é¢˜ã€‚  
   * **å¤„ç†:** è¯¥èŠ‚ç‚¹å®ç°ä¸€ä¸ªPIDæ§åˆ¶å™¨ã€‚  
     * **è¯¯å·®è®¡ç®—:** error \= actual\_distance \- (safe\_time\_gap \* ego\_velocity \+ min\_distance)ã€‚è¿™é‡Œçš„æœŸæœ›è·ç¦»æ˜¯ä¸€ä¸ªåŠ¨æ€å€¼ï¼Œé€šå¸¸ç”±ä¸€ä¸ªå®‰å…¨æ—¶é—´é—´éš™ï¼ˆä¾‹å¦‚ï¼Œ2ç§’ï¼‰åŠ ä¸Šä¸€ä¸ªæœ€å°é™æ­¢è·ç¦»ç»„æˆã€‚  
     * **PIDè®¡ç®—:** å°†æ­¤è¯¯å·®è¾“å…¥PIDæ§åˆ¶å™¨ï¼Œè®¡ç®—å‡ºæ‰€éœ€çš„åŠ é€Ÿåº¦æˆ–å‡é€Ÿåº¦ã€‚  
   * **å‘å¸ƒ:** å°†PIDæ§åˆ¶å™¨çš„è¾“å‡ºè½¬æ¢ä¸ºæ²¹é—¨å’Œåˆ¹è½¦æŒ‡ä»¤ï¼Œå¹¶å‘å¸ƒåˆ°/carla/ego\_vehicle/vehicle\_control\_cmdè¯é¢˜ã€‚å¦‚æœè¾“å‡ºä¸ºæ­£ï¼Œåˆ™è½¬æ¢ä¸ºæ²¹é—¨å€¼ï¼›å¦‚æœä¸ºè´Ÿï¼Œåˆ™è½¬æ¢ä¸ºåˆ¹è½¦å€¼ã€‚

é€šè¿‡åˆ†æå¦‚ethanmclark1/carla\_aebs 44ï¼ˆå°½ç®¡å®ƒä½¿ç”¨äº†å¼ºåŒ–å­¦ä¹ ï¼Œä½†å…¶æ„ŸçŸ¥å’Œæ§åˆ¶åˆ†ç¦»çš„æ€æƒ³æ˜¯ç›¸é€šçš„ï¼‰å’ŒZhuoyunZhong/Personalizing-ADAS-in-CARLA 45ä¸­çš„ACCæ¦‚å¿µï¼Œå¯ä»¥ä¸ºæ„å»ºæ­¤ç±»ç³»ç»Ÿæä¾›å‚è€ƒã€‚

---

## **ç¬¬å››éƒ¨åˆ†ï¼šè¿›é˜¶èµ„æºä¸æœªæ¥æ–¹å‘**

æœ¬æŠ¥å‘Šä¸ºæ‚¨æä¾›äº†ä»é›¶å¼€å§‹æ­å»ºCARLA-ROSç¯å¢ƒå¹¶å®ç°åŸºç¡€ADASåŠŸèƒ½çš„å®Œæ•´æŒ‡å—ã€‚ä¸ºäº†æ”¯æŒæ‚¨åœ¨è‡ªåŠ¨é©¾é©¶é¢†åŸŸçš„æŒç»­å­¦ä¹ å’Œæ¢ç´¢ï¼Œæœ¬éƒ¨åˆ†å°†æä¾›ä¸€ä»½ç²¾é€‰çš„å¼€æºé¡¹ç›®åˆ—è¡¨ï¼Œå¹¶æ€»ç»“å…³é”®çš„æœ€ä½³å®è·µã€‚

### **ç¬¬7èŠ‚ï¼šçŸ¥åCARLA-ROSå¼€æºé¡¹ç›®æ¦‚è§ˆ**

æ¢ç´¢å’Œå­¦ä¹ ç°æœ‰çš„å¼€æºé¡¹ç›®æ˜¯æå‡æŠ€èƒ½çš„æœ€æœ‰æ•ˆæ–¹æ³•ä¹‹ä¸€ã€‚ä»¥ä¸‹é¡¹ç›®è¦†ç›–äº†ä»å®Œæ•´çš„è‡ªåŠ¨é©¾é©¶è½¯ä»¶æ ˆåˆ°ç‰¹å®šç®—æ³•å®ç°ç­‰ä¸åŒå±‚é¢ã€‚

#### **7.1 å®Œæ•´çš„è‡ªåŠ¨é©¾é©¶è½¯ä»¶æ ˆ**

è¿™äº›é¡¹ç›®æ—¨åœ¨å®ç°ä¸€ä¸ªç«¯åˆ°ç«¯çš„è‡ªåŠ¨é©¾é©¶ç³»ç»Ÿï¼Œé€šå¸¸åŒ…å«æ„ŸçŸ¥ã€è§„åˆ’å’Œæ§åˆ¶çš„å®Œæ•´æ¨¡å—ï¼Œæ˜¯ç†è§£ç³»ç»Ÿé›†æˆçš„ç»ä½³æ¡ˆä¾‹ã€‚

* **soumya997/carla-e2e-av-stack** 8: è¿™ä¸ªé¡¹ç›®æä¾›äº†ä¸€ä¸ªå³æ’å³ç”¨çš„æ„ŸçŸ¥å’Œæ§åˆ¶æ ˆï¼Œå…¼å®¹CARLA 0.9.11ä»¥åŠROS1 Noeticå’ŒROS2 Humbleã€‚å…¶åŠŸèƒ½åŒ…æ‹¬åŠ è½½åœ°å›¾ã€ä½¿ç”¨RVizè®¾ç½®ç›®æ ‡ç‚¹ã€åŸºäºA-LOAMçš„æ¿€å…‰é›·è¾¾é‡Œç¨‹è®¡ã€PIDè·¯å¾„è·Ÿè¸ªä»¥åŠIMUå’ŒLiDARçš„EKFä¼ æ„Ÿå™¨èåˆã€‚å®ƒä¸ºROS1å’ŒROS2æä¾›äº†ç‹¬ç«‹çš„å®ç°ï¼Œç»“æ„æ¸…æ™°ã€‚  
* **mohamedameen93/An-Autonomous-Vehicle-System-For-Carla** 7: è¯¥é¡¹ç›®ä¸ºUdacityè‡ªåŠ¨é©¾é©¶è¯¾ç¨‹è€Œæ„å»ºï¼Œå…¶ROSèŠ‚ç‚¹å®ç°äº†è‡ªåŠ¨é©¾é©¶çš„æ ¸å¿ƒåŠŸèƒ½ï¼ŒåŒ…æ‹¬äº¤é€šç¯æ£€æµ‹ä¸åˆ†ç±»ã€è½¦è¾†æ§åˆ¶å’Œè·¯å¾„ç‚¹è·Ÿéšã€‚å®ƒæ¸…æ™°åœ°å±•ç¤ºäº†å¦‚ä½•å°†æ„ŸçŸ¥ï¼ˆäº¤é€šç¯çŠ¶æ€ï¼‰ã€è§„åˆ’ï¼ˆè·¯å¾„ç‚¹æ›´æ–°ï¼‰å’Œæ§åˆ¶ï¼ˆDBWï¼ŒDrive-by-Wireï¼‰ä¸‰ä¸ªå­ç³»ç»Ÿåœ¨ROSæ¡†æ¶ä¸‹ååŒå·¥ä½œã€‚

#### **7.2 ä¸“é—¨çš„ADASä¸ç®—æ³•å®ç°**

è¿™äº›é¡¹ç›®ä¸“æ³¨äºè§£å†³è‡ªåŠ¨é©¾é©¶ä¸­çš„ç‰¹å®šé—®é¢˜ï¼Œé€‚åˆæ·±å…¥ç ”ç©¶æŸä¸€å…·ä½“æŠ€æœ¯ã€‚

* **vignif/carla-parking** 46: ä¸€ä¸ªå®ç°è‡ªåŠ¨æ³Šè½¦åŠŸèƒ½çš„é¡¹ç›®ã€‚å®ƒé‡‡ç”¨åŸºäºè§„åˆ™çš„å¼€ç¯æ§åˆ¶æ–¹æ³•ï¼Œåœ¨é¢„è®¾çš„åœºæ™¯ä¸­ç”Ÿæˆä¸¤è¾†åœå¥½çš„è½¦ï¼Œå¹¶æ§åˆ¶ä¸»è½¦åœ¨å®ƒä»¬ä¹‹é—´å®Œæˆæ³Šè½¦åŠ¨ä½œã€‚è¿™æ˜¯ä¸€ä¸ªå­¦ä¹ ä½é€Ÿç²¾ç¡®æ“æ§çš„å¥½ä¾‹å­ã€‚  
* **ZhuoyunZhong/Personalizing-ADAS-in-CARLA** 45: è¿™ä¸ªé¡¹ç›®ä¸“æ³¨äºâ€œä¸ªæ€§åŒ–â€ADASï¼Œç‰¹åˆ«æ˜¯è‡ªé€‚åº”å·¡èˆªæ§åˆ¶ï¼ˆACCï¼‰å’Œè½¦é“å˜æ¢ã€‚å®ƒé€šè¿‡å­¦ä¹ é©¾é©¶å‘˜çš„è¡Œä¸ºæ•°æ®ï¼ˆå¦‚æœŸæœ›é€Ÿåº¦ã€å®‰å…¨è½¦å¤´æ—¶è·ï¼‰ï¼Œä½¿ç”¨é«˜æ–¯æ··åˆæ¨¡å‹ï¼ˆGMMï¼‰æ¥è°ƒæ•´ADASçš„å‚æ•°ï¼Œä½¿å…¶æ›´ç¬¦åˆç‰¹å®šé©¾é©¶å‘˜çš„é£æ ¼ã€‚å°½ç®¡å®ƒä¸ç›´æ¥ä½¿ç”¨ROSï¼Œä½†å…¶ç®—æ³•æ€æƒ³å¯¹äºå¼€å‘æ›´äººæ€§åŒ–çš„ADASç³»ç»Ÿå…·æœ‰é‡è¦å‚è€ƒä»·å€¼ã€‚  
* **ethanmclark1/carla\_aebs** 44: ä¸€ä¸ªåŸºäºå¼ºåŒ–å­¦ä¹ çš„è‡ªåŠ¨ç´§æ€¥åˆ¶åŠ¨ç³»ç»Ÿã€‚å®ƒåˆ›æ–°åœ°é›†æˆäº†ä¸¤ä¸ªç¥ç»ç½‘ç»œï¼šä¸€ä¸ªç”¨äºè½¦é“è·Ÿéšçš„CNNå’Œä¸€ä¸ªç”¨äºå†³ç­–çš„Dueling DQNï¼Œç»“åˆè§†è§‰è¾“å…¥ã€é€Ÿåº¦å’Œè·ç¦»ä¿¡æ¯æ¥æ‰§è¡Œåˆ¶åŠ¨ï¼Œå±•ç¤ºäº†å°†ç°ä»£AIæŠ€æœ¯åº”ç”¨äºä¼ ç»ŸADASé—®é¢˜çš„å‰æ²¿æ–¹æ³•ã€‚

#### **7.3 å–„ç”¨å®˜æ–¹ç¤ºä¾‹**

carla-ros-bridgeæœ¬èº«å°±æä¾›äº†ä¸€äº›éå¸¸æœ‰ä»·å€¼çš„ç¤ºä¾‹åŒ…ï¼Œå®ƒä»¬æ˜¯æ„å»ºè‡ªå®šä¹‰ç³»ç»Ÿçš„ç†æƒ³èµ·ç‚¹ã€‚

* **carla\_ad\_agent** å’Œ **carla\_ad\_demo** 9: è¿™ä¸¤ä¸ªåŒ…å…±åŒæ„æˆäº†ä¸€ä¸ªç®€å•çš„è‡ªåŠ¨é©¾é©¶ä»£ç†ã€‚carla\_ad\_agentå®ç°äº†ä¸€ä¸ªåŸºæœ¬çš„è¡Œä¸ºä»£ç†ï¼Œèƒ½å¤Ÿè·Ÿéšè·¯å¾„ã€é¿å…ç¢°æ’å¹¶éµå®ˆäº¤é€šè§„åˆ™ã€‚carla\_ad\_demoåˆ™æä¾›äº†å¯åŠ¨è¿™ä¸ªä»£ç†æ‰€éœ€çš„æ‰€æœ‰é…ç½®ã€‚é€šè¿‡ç ”ç©¶å’Œä¿®æ”¹è¿™ä¸¤ä¸ªåŒ…ï¼Œæ‚¨å¯ä»¥å¿«é€Ÿæ­å»ºèµ·è‡ªå·±çš„è‡ªåŠ¨é©¾é©¶åŸå‹ï¼Œè€Œæ— éœ€ä»é›¶å¼€å§‹ç¼–å†™æ‰€æœ‰åŸºç¡€é€»è¾‘ã€‚

### **ç¬¬8èŠ‚ï¼šç»“è®ºï¼šä»æ–°æ‰‹åˆ°å®è·µè€…**

æœ¬æ‰‹å†Œå¼•é¢†æ‚¨å®Œæˆäº†ä»ç¯å¢ƒæ­å»ºåˆ°åŸºç¡€ADASå¼€å‘çš„å®Œæ•´æ—…ç¨‹ã€‚æ•´ä¸ªå·¥ä½œæµç¨‹å¯ä»¥æ€»ç»“ä¸ºå››ä¸ªæ ¸å¿ƒæ­¥éª¤ï¼š**æ­å»º (Setup) \-\> äº¤äº’ (Interface) \-\> å®ç° (Implement) \-\> æµ‹è¯• (Test)**ã€‚

**æœ€ä½³å®è·µæ€»ç»“:**

* **ç‰ˆæœ¬æ§åˆ¶è‡³å…³é‡è¦:** åœ¨å¼€å§‹ä»»ä½•é¡¹ç›®ä¹‹å‰ï¼Œè¯·ä½¿ç”¨ç‰ˆæœ¬å…¼å®¹æ€§çŸ©é˜µï¼ˆè¡¨2.1ï¼‰ç¡®ä¿æ‚¨çš„CARLAã€ROSå’Œros-bridgeç‰ˆæœ¬ç›¸äº’åŒ¹é…ã€‚è¿™æ˜¯é¿å…æŒ«è´¥æ„Ÿå’ŒèŠ‚çœè°ƒè¯•æ—¶é—´çš„æœ€é‡è¦ä¸€æ­¥ã€‚  
* **åšæŒä½¿ç”¨åŒæ­¥æ¨¡å¼:** å¯¹äºä»»ä½•éœ€è¦å¯å¤ç°ç»“æœçš„å¼€å‘å’Œæµ‹è¯•å·¥ä½œï¼Œè¯·å§‹ç»ˆå¯ç”¨åŒæ­¥æ¨¡å¼ã€‚è¿™æ˜¯ä¿è¯æ•°æ®ä¸€è‡´æ€§å’Œç®—æ³•å¯é æ€§çš„åŸºçŸ³ã€‚  
* **å°†RVizä½œä¸ºæ‚¨çš„è°ƒè¯•åˆ©å™¨:** å……åˆ†åˆ©ç”¨RVizæ¥å¯è§†åŒ–ä¼ æ„Ÿå™¨æ•°æ®ã€è½¦è¾†ä½å§¿ã€è§„åˆ’è·¯å¾„å’Œå†…éƒ¨çŠ¶æ€ã€‚ç›´è§‚åœ°çœ‹åˆ°ç³»ç»Ÿæ­£åœ¨â€œæƒ³â€ä»€ä¹ˆï¼Œæ˜¯è°ƒè¯•å¤æ‚ç®—æ³•çš„æœ€é«˜æ•ˆæ–¹å¼ã€‚  
* **ä»æ¨¡å—åŒ–å¼€å§‹:** éµå¾ªROSçš„è®¾è®¡å“²å­¦ï¼Œå°†æ‚¨çš„ç³»ç»Ÿåˆ†è§£ä¸ºç‹¬ç«‹çš„ã€åŠŸèƒ½å•ä¸€çš„èŠ‚ç‚¹ã€‚è¿™ä¸ä»…ä½¿ä»£ç æ›´æ˜“äºç®¡ç†å’Œæµ‹è¯•ï¼Œä¹Ÿæé«˜äº†å…¶å¯å¤ç”¨æ€§ã€‚

æœªæ¥æ–¹å‘:  
éšç€æ‚¨å¯¹åŸºç¡€çŸ¥è¯†çš„æŒæ¡ï¼Œå¯ä»¥å‘æ›´é«˜çº§çš„ä¸»é¢˜è¿ˆè¿›ï¼š

* **CARLA Scenario Runner:** è¿™æ˜¯CARLAå®˜æ–¹æä¾›çš„ä¸€ä¸ªå·¥å…·ï¼Œç”¨äºæ‰§è¡ŒåŸºäºOpenSCENARIOæ ‡å‡†çš„äº¤é€šåœºæ™¯æµ‹è¯•ã€‚é€šè¿‡carla\_ros\_scenario\_runneråŒ…ï¼Œæ‚¨å¯ä»¥å°†è¿™äº›æ ‡å‡†åŒ–çš„æµ‹è¯•åœºæ™¯é›†æˆåˆ°ROSå·¥ä½œæµç¨‹ä¸­ï¼Œå¯¹æ‚¨çš„è‡ªåŠ¨é©¾é©¶ç®—æ³•è¿›è¡Œç³»ç»ŸåŒ–ã€æ ‡å‡†åŒ–çš„éªŒè¯ 9ã€‚  
* **å¤šæ™ºèƒ½ä½“ä¸ååŒä»¿çœŸ:** CARLAæ”¯æŒä¸å…¶ä»–ä»¿çœŸå™¨è¿›è¡ŒååŒä»¿çœŸï¼Œæœ€è‘—åçš„æ˜¯ä¸äº¤é€šæµä»¿çœŸå™¨SUMOçš„é›†æˆ 4ã€‚è¿™ä½¿å¾—æ‚¨å¯ä»¥åœ¨å®è§‚å±‚é¢æ¨¡æ‹Ÿå¤æ‚çš„åŸå¸‚äº¤é€šæµï¼ˆç”±SUMOè´Ÿè´£ï¼‰ï¼ŒåŒæ—¶åœ¨å¾®è§‚å±‚é¢ç²¾ç¡®æ¨¡æ‹Ÿè‡ªåŠ¨é©¾é©¶è½¦è¾†åŠå…¶ä¼ æ„Ÿå™¨çš„è¡Œä¸ºï¼ˆç”±CARLAè´Ÿè´£ï¼‰ï¼Œä¸ºæ›´é«˜çº§çš„V2Xï¼ˆVehicle-to-Everythingï¼‰é€šä¿¡å’Œç¾¤ä½“æ™ºèƒ½ç®—æ³•ç ”ç©¶æä¾›äº†å¯èƒ½ã€‚

è‡ªåŠ¨é©¾é©¶æ˜¯ä¸€ä¸ªå……æ»¡æŒ‘æˆ˜å’Œæœºé‡çš„è·¨å­¦ç§‘é¢†åŸŸã€‚é€šè¿‡å°†CARLAçš„é«˜ä¿çœŸä»¿çœŸèƒ½åŠ›ä¸ROSå¼ºå¤§çš„è½¯ä»¶ç”Ÿæ€ç³»ç»Ÿç›¸ç»“åˆï¼Œæ‚¨å·²ç»æ‹¥æœ‰äº†ä¸€ä¸ªä¸–ç•Œä¸€æµçš„å¼€å‘å’Œç ”ç©¶å¹³å°ã€‚å¸Œæœ›æœ¬æ‰‹å†Œèƒ½æˆä¸ºæ‚¨æ¢ç´¢è¿™ä¸ªæ¿€åŠ¨äººå¿ƒé¢†åŸŸå¾ç¨‹ä¸­çš„åšå®èµ·ç‚¹ã€‚

#### **Works cited**

1. carla-simulator/carla: Open-source simulator for autonomous driving research. \- GitHub, accessed October 24, 2025, [https://github.com/carla-simulator/carla](https://github.com/carla-simulator/carla)  
2. CARLA Simulator, accessed October 24, 2025, [https://carla.org/](https://carla.org/)  
3. ROS Bridge \- CARLA Simulator, accessed October 24, 2025, [https://carla.readthedocs.io/en/latest/ros\_documentation/](https://carla.readthedocs.io/en/latest/ros_documentation/)  
4. 3rd Party Integrations \- CARLA Simulator, accessed October 24, 2025, [https://carla.readthedocs.io/en/latest/3rd\_party\_integrations/](https://carla.readthedocs.io/en/latest/3rd_party_integrations/)  
5. ROS-CARLA Integration \> How to use ROS Bridge package \- Semi-Automatic Labelling for Atlascar using Adaptive Perception, accessed October 24, 2025, [https://silvamfpedro.github.io/thesis-blog/manual.html](https://silvamfpedro.github.io/thesis-blog/manual.html)  
6. UrbanPistek/carla\_ros\_simulation: A simulation stack using Docker to run CARLA with ROS nodes and additional tooling such as Foxglove. \- GitHub, accessed October 24, 2025, [https://github.com/UrbanPistek/carla\_ros\_simulation](https://github.com/UrbanPistek/carla_ros_simulation)  
7. mohamedameen93/An-Autonomous-Vehicle-System-For-Carla: In this project, we built ROS nodes to implement the core functionality of the autonomous vehicle system, including traffic light detection and classification, vehicle control control, and waypoint following. \- GitHub, accessed October 24, 2025, [https://github.com/mohamedameen93/An-Autonomous-Vehicle-System-For-Carla](https://github.com/mohamedameen93/An-Autonomous-Vehicle-System-For-Carla)  
8. soumya997/carla-e2e-av-stack: This repository contains the ... \- GitHub, accessed October 24, 2025, [https://github.com/soumya997/carla-e2e-av-stack](https://github.com/soumya997/carla-e2e-av-stack)  
9. ROS Bridge Documentation \- CARLA Simulator \- Read the Docs, accessed October 24, 2025, [https://carla.readthedocs.io/projects/ros-bridge/en/latest/](https://carla.readthedocs.io/projects/ros-bridge/en/latest/)  
10. Simulation Environment for Validation of Automated Lane-Keeping System, accessed October 24, 2025, [https://dspace.cvut.cz/bitstream/handle/10467/112330/Vlasak\_Sojka\_Hanzalek\_\_Simulation\_Environment\_for\_Validation\_of\_Automated\_LaneKeeping\_System\_\_%282023%29\_AAM\_369040.pdf](https://dspace.cvut.cz/bitstream/handle/10467/112330/Vlasak_Sojka_Hanzalek__Simulation_Environment_for_Validation_of_Automated_LaneKeeping_System__%282023%29_AAM_369040.pdf)  
11. carla-simulator/ros-bridge \- GitHub, accessed October 24, 2025, [https://github.com/carla-simulator/ros-bridge](https://github.com/carla-simulator/ros-bridge)  
12. ROS2 and Carla Setup Guide for Ubuntu 22.04 \- LearnOpenCV, accessed October 24, 2025, [https://learnopencv.com/ros2-and-carla-setup-guide/](https://learnopencv.com/ros2-and-carla-setup-guide/)  
13. ttgamage/carla-ros-bridge: ROS Humble bridge for CARLA v0.9.15 \- GitHub, accessed October 24, 2025, [https://github.com/ttgamage/carla-ros-bridge](https://github.com/ttgamage/carla-ros-bridge)  
14. gezp/carla\_ros: ROS bridge for CARLA Simulator \- GitHub, accessed October 24, 2025, [https://github.com/gezp/carla\_ros](https://github.com/gezp/carla_ros)  
15. Install Carla-ROS Bridge in Ubuntu 18.04 | by Francisco Maria | Medium, accessed October 24, 2025, [https://francismaria.medium.com/install-carla-ros-bridge-in-ubuntu-18-04-94fe972ec529](https://francismaria.medium.com/install-carla-ros-bridge-in-ubuntu-18-04-94fe972ec529)  
16. Ros Carla Simulator | PDF | Lidar | Computing \- Scribd, accessed October 24, 2025, [https://www.scribd.com/document/907728042/Ros-Carla-Simulator](https://www.scribd.com/document/907728042/Ros-Carla-Simulator)  
17. MPC-Berkeley/carla-ros-bridge: ROS bridge for CARLA Simulator. Goes with fork of Carla simulator. \- GitHub, accessed October 24, 2025, [https://github.com/MPC-Berkeley/carla-ros-bridge](https://github.com/MPC-Berkeley/carla-ros-bridge)  
18. The ROS bridge package \- CARLA Simulator, accessed October 24, 2025, [https://carla.readthedocs.io/projects/ros-bridge/en/latest/run\_ros/](https://carla.readthedocs.io/projects/ros-bridge/en/latest/run_ros/)  
19. Launchfiles reference \- CARLA Simulator \- Read the Docs, accessed October 24, 2025, [https://carla.readthedocs.io/en/0.9.8/ros\_launchs/](https://carla.readthedocs.io/en/0.9.8/ros_launchs/)  
20. CARLA sensor reference \- CARLA Simulator \- CARLA documentation, accessed October 24, 2025, [https://carla.readthedocs.io/projects/ros-bridge/en/latest/ros\_sensors/](https://carla.readthedocs.io/projects/ros-bridge/en/latest/ros_sensors/)  
21. lardemua/ros\_bridge: ROS Bridge Driver for Carla Simulator package : https://github.com/carla-simulator/carla \- GitHub, accessed October 24, 2025, [https://github.com/lardemua/ros\_bridge](https://github.com/lardemua/ros_bridge)  
22. Set Up and Connect to CARLA Simulator \- MATLAB & Simulink, accessed October 24, 2025, [https://www.mathworks.com/help/ros/ug/set-up-and-connect-to-carla-simulator.html](https://www.mathworks.com/help/ros/ug/set-up-and-connect-to-carla-simulator.html)  
23. OpenCV | Real Time Road Lane Detection \- GeeksforGeeks, accessed October 24, 2025, [https://www.geeksforgeeks.org/machine-learning/opencv-real-time-road-lane-detection/](https://www.geeksforgeeks.org/machine-learning/opencv-real-time-road-lane-detection/)  
24. Tutorial: Build a lane detector \- Towards Data Science, accessed October 24, 2025, [https://towardsdatascience.com/tutorial-build-a-lane-detector-679fd8953132/](https://towardsdatascience.com/tutorial-build-a-lane-detector-679fd8953132/)  
25. Hands-On Tutorial on Real-Time Lane Detection using OpenCV (Self-Driving Car Project\!), accessed October 24, 2025, [https://www.analyticsvidhya.com/blog/2020/05/tutorial-real-time-lane-detection-opencv/](https://www.analyticsvidhya.com/blog/2020/05/tutorial-real-time-lane-detection-opencv/)  
26. OpenCV Line Detection | by Amit Yadav \- Medium, accessed October 24, 2025, [https://medium.com/@amit25173/opencv-line-detection-ccf6ee026c5c](https://medium.com/@amit25173/opencv-line-detection-ccf6ee026c5c)  
27. OpenCV Python Tutorial For Beginners 31 \- Road Lane Line Detection with OpenCV (Part 1), accessed October 24, 2025, [https://www.youtube.com/watch?v=yvfI4p6Wyvk](https://www.youtube.com/watch?v=yvfI4p6Wyvk)  
28. Pure Pursuit Controller \- MATLAB & Simulink \- MathWorks, accessed October 24, 2025, [https://www.mathworks.com/help/nav/ug/pure-pursuit-controller.html](https://www.mathworks.com/help/nav/ug/pure-pursuit-controller.html)  
29. Implementation of the Pure Pursuit Path Tracking Algorithm \- CMU Robotics Institute, accessed October 24, 2025, [https://www.ri.cmu.edu/pub\_files/pub3/coulter\_r\_craig\_1992\_1/coulter\_r\_craig\_1992\_1.pdf](https://www.ri.cmu.edu/pub_files/pub3/coulter_r_craig_1992_1/coulter_r_craig_1992_1.pdf)  
30. Pure Pursuit \- F1TENTH L10 \- YouTube, accessed October 24, 2025, [https://www.youtube.com/watch?v=x9s8J4ucgO0](https://www.youtube.com/watch?v=x9s8J4ucgO0)  
31. Lateral Controller Stanley \- Control steering angle of vehicle for path following by using Stanley method \- Simulink \- MathWorks, accessed October 24, 2025, [https://www.mathworks.com/help/driving/ref/lateralcontrollerstanley.html](https://www.mathworks.com/help/driving/ref/lateralcontrollerstanley.html)  
32. A Stanley Controller Design for Enhancing Vehicle Lane Keeping and Departure Performance Using Active Rear Wheel Steering | Request PDF \- ResearchGate, accessed October 24, 2025, [https://www.researchgate.net/publication/372842885\_A\_Stanley\_Controller\_Design\_for\_Enhancing\_Vehicle\_Lane\_Keeping\_and\_Departure\_Performance\_Using\_Active\_Rear\_Wheel\_Steering](https://www.researchgate.net/publication/372842885_A_Stanley_Controller_Design_for_Enhancing_Vehicle_Lane_Keeping_and_Departure_Performance_Using_Active_Rear_Wheel_Steering)  
33. Geometric explanation of Stanley controller. | Download Scientific Diagram \- ResearchGate, accessed October 24, 2025, [https://www.researchgate.net/figure/Geometric-explanation-of-Stanley-controller\_fig5\_351468458](https://www.researchgate.net/figure/Geometric-explanation-of-Stanley-controller_fig5_351468458)  
34. Erendrgnl/Carla-Ros-Lane-Keeping-System \- GitHub, accessed October 24, 2025, [https://github.com/Erendrgnl/Carla-Ros-Lane-Keeping-System](https://github.com/Erendrgnl/Carla-Ros-Lane-Keeping-System)  
35. paulyehtw/Lane-Keeping-Assist-on-CARLA: Implementing ... \- GitHub, accessed October 24, 2025, [https://github.com/paulyehtw/Lane-Keeping-Assist-on-CARLA](https://github.com/paulyehtw/Lane-Keeping-Assist-on-CARLA)  
36. Adaptive Cruise Control Method for Automobiles Based on Dynamic Spacing Strategy & PID, accessed October 24, 2025, [https://www.ewadirect.com/proceedings/ace/article/view/21693](https://www.ewadirect.com/proceedings/ace/article/view/21693)  
37. Proportionalâ€“integralâ€“derivative controller \- Wikipedia, accessed October 24, 2025, [https://en.wikipedia.org/wiki/Proportional%E2%80%93integral%E2%80%93derivative\_controller](https://en.wikipedia.org/wiki/Proportional%E2%80%93integral%E2%80%93derivative_controller)  
38. From Cruise Control to Complex Industrial Systems â€“ A Deep Dive into PID Control, accessed October 24, 2025, [https://electronicdrives.com/home/pid-control/](https://electronicdrives.com/home/pid-control/)  
39. US20170210360A1 \- Estimated time-to-collision (ttc) calculation apparatus and estimated ttc calculation method \- Google Patents, accessed October 24, 2025, [https://patents.google.com/patent/US20170210360A1/en](https://patents.google.com/patent/US20170210360A1/en)  
40. Assessing The Safety Benefit of Automatic Collision Avoidance Systems (During Emergency Braking Situations) \- NHTSA, accessed October 24, 2025, [https://www.nhtsa.gov/sites/nhtsa.gov/files/18esv-000381.pdf](https://www.nhtsa.gov/sites/nhtsa.gov/files/18esv-000381.pdf)  
41. (PDF) Calculating the Brake-Application Time of AEB System by Considering Maximum Deceleration Rate during a Primary Accident in Penang's Urban Road \- ResearchGate, accessed October 24, 2025, [https://www.researchgate.net/publication/343650815\_Calculating\_the\_Brake-Application\_Time\_of\_AEB\_System\_by\_Considering\_Maximum\_Deceleration\_Rate\_during\_a\_Primary\_Accident\_in\_Penang's\_Urban\_Road](https://www.researchgate.net/publication/343650815_Calculating_the_Brake-Application_Time_of_AEB_System_by_Considering_Maximum_Deceleration_Rate_during_a_Primary_Accident_in_Penang's_Urban_Road)  
42. Digital Twin for CAV â€” Part 2 (CARLA, ROS2 and Simulink Implementation ğŸ—ï¸) \- Medium, accessed October 24, 2025, [https://medium.com/networkers-fiit-stu/digital-twin-for-automated-vehicles-using-carla-simulator-ros2-and-matlab-simulink-e87df45c6a6a](https://medium.com/networkers-fiit-stu/digital-twin-for-automated-vehicles-using-carla-simulator-ros2-and-matlab-simulink-e87df45c6a6a)  
43. Evaluation and Optimization of Adaptive Cruise Control in Autonomous Vehicles using the CARLA Simulator: A Study on Performance \- arXiv, accessed October 24, 2025, [https://arxiv.org/pdf/2405.01504](https://arxiv.org/pdf/2405.01504)  
44. ethanmclark1/carla\_aebs: Reinforcement learning based ... \- GitHub, accessed October 24, 2025, [https://github.com/ethanmclark1/carla\_aebs](https://github.com/ethanmclark1/carla_aebs)  
45. ZhuoyunZhong/Personalizing-ADAS-in-CARLA ... \- GitHub, accessed October 24, 2025, [https://github.com/ZhuoyunZhong/Personalizing-ADAS-in-CARLA](https://github.com/ZhuoyunZhong/Personalizing-ADAS-in-CARLA)  
46. vignif/carla-parking: carla simulator for autonomous driving research \- GitHub, accessed October 24, 2025, [https://github.com/vignif/carla-parking](https://github.com/vignif/carla-parking)